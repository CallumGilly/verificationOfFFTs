%TC:ignore
\begin{code}[hide]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--guardedness}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Implementation}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\end{code}
%TC:endignore
\section{Compilation}

Given the definition of the FFT, and proof of its correctness, it is 
is now possible for us to generate runnable code with the same guarantees of 
correctness attached.
A runnable instance of this FFT implementation can be generated through use of
Agda's Builtin IO library, and the GHC Haskell backend.
The IO library allows for the definition of output and an entry point into the
program.
The GHC Haskell backend allows for translation into runnable Haskell, allowing
us to confirm that the FFT and DFT implementations run and produce expected
results.

\subsection{Complex Numbers}
To generate a runnable instance of the FFT as defined, an implementation of
the Complex numbers must be defined.
For the example shown here, I have defined complex numbers as pairs of
Agda's builtin \AF{Float}.

Unlike other number systems in Agda, builtin \AF{Float} is not defined 
inductively, and is instead a wrapper around IEEE 754 \cite{IEEE754}.
This means that no properties, such as commutativity or associativity, are 
provided and that any such property must be assumed through postulations.
This weakens implementations built on top of \AF{Float}, as they
become prone to minor floating point errors.
Such errors are generally unavoidable, however, within floating point 
mathematics, and the resultant effects are generally well 
studied.\cite{FFT4Profit}
This makes the use of builtin \AF{Float} acceptable for 
most implementations.

Given this implementation of floating point numbers as ℝ, the carrier, ℂ,
for complex numbers can be defined as a pair of floating point numbers, 
representing the real and imaginary components.
%TC:ignore
\begin{code}[hide]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Real}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Real}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Complex}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Cplx}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{Eq}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Eq}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Eq.≡-Reasoning}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Algebra.Structures}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{IsCommutativeRing}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{ℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+ₙ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{m*n≢0}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Agda.Builtin.String}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{implementationComplex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{real}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Real}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Agda.Builtin.Float}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{primFloatPlus}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPostulate{Float}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaPostulate{ℝ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaComment{--\ open\ Real.Real\ real\ using\ (ℝ;\ \AgdaUnderscore{}ᵣ;\ cos;\ sin;\ π)\ renaming\ (-\AgdaUnderscore{}\ to\ -ᵣ\AgdaUnderscore{};\ }\<%
\\
%
\>[2]\AgdaComment{--\ \ \ \AgdaUnderscore{}+\AgdaUnderscore{}\ to\ \AgdaUnderscore{}+ᵣ\AgdaUnderscore{};\ \AgdaUnderscore{}-\AgdaUnderscore{}\ to\ \AgdaUnderscore{}-ᵣ\AgdaUnderscore{};\ \AgdaUnderscore{}*\AgdaUnderscore{}\ to\ \AgdaUnderscore{}*ᵣ\AgdaUnderscore{};\ \AgdaUnderscore{}/\AgdaUnderscore{}\ to\ \AgdaUnderscore{}/ᵣ\AgdaUnderscore{})}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Base}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\end{code}
%TC:endignore

\begin{AgdaMultiCode}
\begin{code}%
\>[2][@{}l@{\AgdaIndent{1}}]%
\>[4]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{constructor}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}+\AgdaUnderscore{}i}}\<%
\\
%
\>[6]\AgdaKeyword{field}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaField{real-component}%
\>[28]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{ℝ}\<%
\\
%
\>[8]\AgdaField{imaginary-component}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{ℝ}\<%
\end{code}

A constructor for ℂ is defined at the same time, allowing for composition 
and decomposition into component parts.
Builtin \AF{Float} then provides wrappers around some primitive operations 
which can be used to define the required methods on this carrier set,
such as addition.

\begin{code}%
%
\>[4]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xRe}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{xIm}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{yRe}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{yIm}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{primFloatPlus}\AgdaSpace{}%
\AgdaBound{xRe}\AgdaSpace{}%
\AgdaBound{yRe}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaPrimitive{primFloatPlus}\AgdaSpace{}%
\AgdaBound{xIm}%
\>[54]\AgdaBound{yIm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\<%
\end{code}
\end{AgdaMultiCode}

Once all of these method are defined, their properties can be proven or
postulated.
In an ideal implementation, all postulations would be made on the methods of 
builtin \AF{Float}, and the properties of complex would be paired with proofs.
However, for this example I have chosen to postulate the properties
of complex directly as to improve the simplicity of this example.

%TC:ignore
\begin{code}[hide]%
\>[0]\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Complex2}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{real}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Real}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Real.Real}\AgdaSpace{}%
\AgdaBound{real}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ℝ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}ᵣ}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{cos}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{sin}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{π}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}-ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}/\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}/ᵣ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Base}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{constructor}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}+\AgdaUnderscore{}i}}\<%
\\
%
\>[6]\AgdaKeyword{field}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaField{real-component}%
\>[28]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ℝ}\<%
\\
%
\>[8]\AgdaField{imaginary-component}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ℝ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{0ℂ}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaFunction{0ℂ}%
\>[8]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}%
\>[15]\AgdaSymbol{(}\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaField{ᵣ}}\AgdaSymbol{)}%
\>[22]\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaField{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{-1ℂ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaFunction{-1ℂ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaOperator{\AgdaField{-ᵣ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaNumber{1}\AgdaSpace{}%
\AgdaOperator{\AgdaField{ᵣ}}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaField{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaFunction{1ℂ}%
\>[8]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaFunction{1ℂ}%
\>[8]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}%
\>[15]\AgdaSymbol{(}\AgdaNumber{1}\AgdaSpace{}%
\AgdaOperator{\AgdaField{ᵣ}}\AgdaSymbol{)}%
\>[22]\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaField{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xRe}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{xIm}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{yRe}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{yIm}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xRe}\AgdaSpace{}%
\AgdaOperator{\AgdaField{+ᵣ}}\AgdaSpace{}%
\AgdaBound{yRe}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xIm}\AgdaSpace{}%
\AgdaOperator{\AgdaField{+ᵣ}}\AgdaSpace{}%
\AgdaBound{yIm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xRe}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{xIm}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{yRe}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{yIm}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xRe}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-ᵣ}}\AgdaSpace{}%
\AgdaBound{yRe}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xIm}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-ᵣ}}\AgdaSpace{}%
\AgdaBound{yIm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaOperator{\AgdaFunction{-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{re}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{im}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaOperator{\AgdaField{-ᵣ}}\AgdaSpace{}%
\AgdaBound{re}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{-ᵣ}}\AgdaSpace{}%
\AgdaBound{im}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xRe}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{xIm}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{yRe}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{yIm}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{xRe}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*ᵣ}}\AgdaSpace{}%
\AgdaBound{yRe}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-ᵣ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xIm}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*ᵣ}}\AgdaSpace{}%
\AgdaBound{yIm}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{xRe}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*ᵣ}}\AgdaSpace{}%
\AgdaBound{yIm}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{+ᵣ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xIm}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*ᵣ}}\AgdaSpace{}%
\AgdaBound{yRe}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ℝ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaField{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\<%
\\
\>[0]\<%
\\
%
\>[4]\AgdaFunction{ℂfromℕ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaFunction{ℂfromℕ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}ᵣ}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaOperator{\AgdaFunction{e\textasciicircum{}i\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ℝ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{e\textasciicircum{}i\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{cos}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{sin}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\<%
\\
\>[0]\<%
\\
%
\>[4]\AgdaFunction{ℂ-conjugate}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaFunction{ℂ-conjugate}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{re}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{im}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{re}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{-ᵣ}}\AgdaSpace{}%
\AgdaBound{im}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{-ω}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{.⦃}\AgdaSpace{}%
\AgdaBound{nonZero-n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
%
\>[4]\AgdaFunction{-ω}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{e\textasciicircum{}i}}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaOperator{\AgdaField{-ᵣ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaField{ᵣ}}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*ᵣ}}\AgdaSpace{}%
\AgdaField{π}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*ᵣ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaField{ᵣ}}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaField{/ᵣ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{N}\AgdaSpace{}%
\AgdaOperator{\AgdaField{ᵣ}}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaKeyword{postulate}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaPostulate{isCommutativeRing}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{IsCommutativeRing}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{1ℂ}\<%
\\
%
\>[6]\AgdaPostulate{ω-N-0}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{-ω}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{1ℂ}\<%
\\
%
\>[6]\AgdaPostulate{ω-N-mN}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{-ω}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{N}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{1ℂ}\<%
\\
%
\>[6]\AgdaPostulate{ω-r₁x-r₁y}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-r₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{y}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{-ω}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaBound{y}\<%
\\
%
\>[6]\AgdaPostulate{ω-N-k₀+k₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{-ω}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{-ω}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{-ω}\AgdaSpace{}%
\AgdaBound{N}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{)}\<%
\\
\>[0]\<%
\end{code}
%TC:endignore
\begin{AgdaAlign}
\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[4]\AgdaFunction{complexImplementation}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Cplx}\AgdaSpace{}%
\AgdaBound{real}\<%
\\
%
\>[4]\AgdaFunction{complexImplementation}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}\AgdaSpace{}%
\AgdaSymbol{\{}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{ℂ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaRecord{ℂ}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}+\AgdaUnderscore{}}}\<%
\\
%
\>[8]\AgdaComment{--\ ...}\<%
\end{code}
\end{AgdaAlign}
%TC:ignore
\begin{code}[hide]%
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}-\AgdaUnderscore{}}}\<%
\\
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-\AgdaUnderscore{}}}%
\>[14]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{-\AgdaUnderscore{}}}\<%
\\
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{fromℝ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{fromℝ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{e\textasciicircum{}i\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{e\textasciicircum{}i\AgdaUnderscore{}}}\<%
\\
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ℂ-conjugate}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{ℂ-conjugate}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{-ω}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{+-*-isCommutativeRing}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{isCommutativeRing}\<%
\\
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-N-0}%
\>[32]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{ω-N-0}\<%
\\
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-N-mN}%
\>[32]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{ω-N-mN}\<%
\\
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-r₁x-r₁y}%
\>[32]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{ω-r₁x-r₁y}\<%
\\
%
\>[8]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-N-k₀+k₁}%
\>[32]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPostulate{ω-N-k₀+k₁}\<%
\\
\>[4][@{}l@{\AgdaIndent{1}}]%
\>[6]\AgdaSymbol{\}}\<%
\\
\>[0][@{}l@{\AgdaIndent{2}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Base}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Cplx}\AgdaSpace{}%
\AgdaFunction{complexImplementation}\<%
\end{code}
%TC:endignore

This implementation of complex numbers then allows for the FFT to be
instantiated. 

\subsection{Runnable FFT}

Given a concrete definition of the complex numbers, it is now possible to run 
my implementation of the FFT.
The methods are not intended to be efficiant or practical for most uses.
The input is hard coded before compilation, and the Haskell back-end is used to
execute, however, it does allow for the results to be shown and analysed.

The \verb|main| method is the entry point to the program and defines the input 
to run on which is parsed to \AF{show-full-stack}.
\AF{show-full-stack} is then able to print out 
the original tensor, the tensor in vector form, the flat
result of running the FFT, and the flat result of running the DFT.

%TC:ignore
\begin{code}[hide]%
\>[0]\<%
\\
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Implementation}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Real}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Real}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Implementations.Real}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{realImplementation}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{showℝ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Complex}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Cplx}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Implementations.Complex}\AgdaSpace{}%
\AgdaFunction{realImplementation}\AgdaSpace{}%
\AgdaKeyword{using}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaSymbol{(}\AgdaFunction{complexImplementation}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}+\AgdaUnderscore{}i}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Real.Real}\AgdaSpace{}%
\AgdaFunction{realImplementation}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ℝ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}ᵣ}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Cplx}\AgdaSpace{}%
\AgdaFunction{complexImplementation}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ℂ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{fromℝ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Reshape}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Show}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{showShape}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{show}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{showTensor}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{FFT}\AgdaSpace{}%
\AgdaFunction{realImplementation}\AgdaSpace{}%
\AgdaFunction{complexImplementation}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{FFT}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{DFT}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{IO}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{IO}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{run}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{Main}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}>>\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}>>=\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{IO.Finite}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{putStrLn}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit.Polymorphic.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{⊤}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Agda.Builtin.String}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Show}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{show}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{showNat}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Level}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\$\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{private}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{variable}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[3]\AgdaGeneralizable{a}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{Level}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{private}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{infixl}\AgdaSpace{}%
\AgdaNumber{4}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}++\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}++\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPostulate{String}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{String}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{String}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}++\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaPrimitive{primStringAppend}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaComment{--------------------}\<%
\\
\>[0]\AgdaComment{---\ Show\ Complex\ ---}\<%
\\
\>[0]\AgdaComment{--------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{showℂ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPostulate{String}\<%
\\
\>[0]\AgdaFunction{showℂ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{real}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaBound{imaginary}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{showℝ}\AgdaSpace{}%
\AgdaBound{real}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaString{"\ +\ "}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{showℝ}\AgdaSpace{}%
\AgdaBound{imaginary}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaString{"\ i"}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{showDemoℂ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{IO}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{a}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{⊤}\<%
\\
\>[0]\AgdaFunction{showDemoℂ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{putStrLn}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{showℂ}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaNumber{4}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{+}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{i}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{demo-mat₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaNumber{8}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{ℂ}\<%
\\
\>[0]\AgdaFunction{demo-mat₁}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{1}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{2}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{3}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{4}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{5}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{6}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{7}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{8}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{nil}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{demo-mat₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaNumber{16}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{ℂ}\<%
\\
\>[0]\AgdaFunction{demo-mat₂}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{87}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{13}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{72}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{-}}\AgdaSpace{}%
\AgdaNumber{44}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{99}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{8}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}%
\>[28]\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{-}}\AgdaSpace{}%
\AgdaNumber{63}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{25}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{90}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{-}}\AgdaSpace{}%
\AgdaNumber{31}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{56}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{19}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{-}}\AgdaSpace{}%
\AgdaNumber{100}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{37}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{4}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[2]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}%
\>[20]\AgdaNumber{61}%
\>[24]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{nil}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{demo-mat₃}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaNumber{3}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaNumber{4}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{ℂ}\<%
\\
\>[0]\AgdaFunction{demo-mat₃}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{unnest}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{1}%
\>[23]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{2}%
\>[23]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{3}%
\>[23]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{4}%
\>[23]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{nil}\<%
\\
%
\>[2]\AgdaSymbol{)}%
\>[738I]\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\<%
\\
\>[.][@{}l@{}]\<[738I]%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{5}%
\>[23]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{6}%
\>[23]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{7}%
\>[23]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{8}%
\>[23]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{nil}\<%
\\
%
\>[2]\AgdaSymbol{)}%
\>[757I]\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\<%
\\
\>[.][@{}l@{}]\<[757I]%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{9}%
\>[23]\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{10}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{11}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\<%
\\
%
\>[4]\AgdaFunction{ι-cons}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fromℝ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaNumber{12}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵣ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{nil}\<%
\\
%
\>[2]\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{nil}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{show-arr}%
\>[21]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaFunction{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{IO}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{a}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{⊤}\<%
\\
\>[0]\AgdaFunction{show-flat-arr}%
\>[21]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaFunction{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{IO}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{a}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{⊤}\<%
\\
\>[0]\AgdaFunction{show-flat-FFT-result}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaFunction{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{IO}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{a}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{⊤}\<%
\\
\>[0]\AgdaFunction{show-flat-DFT-result}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaFunction{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{IO}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{a}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{⊤}\<%
\end{code}
%TC:endignore

\begin{code}%
\>[0]\AgdaFunction{show-arr}%
\>[22]\AgdaBound{arr}%
\>[810I]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{putStrLn}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaString{"Tensor:\ \ \ \ \ "}\<%
\\
\>[.][@{}l@{}]\<[810I]%
\>[26]\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{showTensor}\AgdaSpace{}%
\AgdaFunction{showℂ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{show-flat-arr}%
\>[22]\AgdaBound{arr}%
\>[818I]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{putStrLn}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaString{"Flat\ Tensor:"}\<%
\\
\>[.][@{}l@{}]\<[818I]%
\>[26]\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{showTensor}\AgdaSpace{}%
\AgdaFunction{showℂ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaFunction{flatten-reindex}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaFunction{show-flat-FFT-result}%
\>[22]\AgdaBound{arr}%
\>[828I]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{putStrLn}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaString{"FFT\ Result:\ "}\<%
\\
\>[.][@{}l@{}]\<[828I]%
\>[26]\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{showTensor}\AgdaSpace{}%
\AgdaFunction{showℂ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{FFT}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaFunction{show-flat-DFT-result}%
\>[22]\AgdaBound{arr}%
\>[840I]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{putStrLn}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaString{"DFT\ Result:\ "}\<%
\\
\>[.][@{}l@{}]\<[840I]%
\>[26]\AgdaOperator{\AgdaFunction{++}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{showTensor}\AgdaSpace{}%
\AgdaFunction{showℂ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{DFT}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaFunction{flatten-reindex}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSymbol{)))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaFunction{show-full-stack}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaFunction{ℂ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{IO}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{a}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{⊤}\<%
\\
\>[0]\AgdaFunction{show-full-stack}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{do}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaFunction{show-arr}%
\>[24]\AgdaBound{arr}\<%
\\
%
\>[2]\AgdaFunction{show-flat-arr}%
\>[24]\AgdaBound{arr}\<%
\\
%
\>[2]\AgdaFunction{show-flat-FFT-result}%
\>[24]\AgdaBound{arr}\<%
\\
%
\>[2]\AgdaFunction{show-flat-DFT-result}%
\>[24]\AgdaBound{arr}\<%
\end{code}

This allows for my implementation of the DFT and FFT to be ran for any input.
The result of this execution can then be compared against the result of Numpy's 
FFT method, allowing for an average floating point error to be established 
against a well known implementation.
We can expect this average error to be low, but not zero, with an expected worst 
case growth of $\mathcal{O}\left(\log N\right)$\cite{FFT4Profit}.
This is because each operation on floating point numbers introduces minor
rounding errors, and these minor errors then grow with each operation.
As each of the three implementations use different operations in different
orders, can be expected that these rounding errors will grow to different sizes.

I conducted a comparison of results for multiple input tensors.
An example of one of these comparisons is shown below.
All of these comparisons showed similar results, with the results of my 
implementation of the FFT and DFT matching those of the Numpy FFT, 
with some expected rounding errors.
This shows my implementation to work as expected.

\subsubsection{Example test}
For this example, I used the following two dimensional tensor of shape 
\AF{(ι 4 ⊗ ι 4)}, constructed from randomly generated numbers between 
-100 and 100, as input.
\[
\begin{pmatrix}
   87  &  13 &  72 & -44 \\
   99  &   8 & -63 &  25 \\
   90  & -31 &  56 &  19 \\
  -100 &  37 &  4  &  61 \\
\end{pmatrix}
\]

This is flattened for input to the DFT into the vector.

\[
\begin{pmatrix}
   87  &  13 &  72 & -44 & 99  &  \dots   &  61 
\end{pmatrix}
\]

With this tensor used as input, I am able to compare the results of the DFT,
FFT and Python FFT. 
The full results can be found in the attached files, however, they show that the
Agda FFT and DFT produce the same results as the Python FFT, with some expectedly
minor rounding errors.

The average difference between each value of the Agda DFT, and each value of 
the Python FFT is \num{2.23e-13}, while the maximum difference is \num{9.38e-13}.
The same average difference between the Agda FFT, and Python FFT is lower, at 
\num{4.05e-14}, while the maximum difference is \num{1.42e-13}.
Being so low, it is easy to attribute these differences to the issues 
caused by floating point arithmetic as discussed above.

\subsection{Future implementations}

In the paper ``Measuring the Haskell Gap'', Petersen 
et al analyse the difference in performance between the ``best performing 
\verb|c| implementation and the best performing Haskell implementation''.\cite{PetersenHaskell}
In their initial benchmarks, Petersen et al describe implementations compiled
with GHC as between $1.72\times$ and $82.9\times$ slower than \verb|c| counterparts.\cite{PetersenHaskell}
As translation into a GHC Haskell program is a required step to run my above implementation,
this same negative performance is parsed on.

This is not, however, the only method with which an Agda definition can be
made runnable.
My formally proven FFT implementation can instead be ported into SaC
\cite{ScholzSac}, an array language.
Such a port would then allow for the introduction of parallelism, as well as
allowing for use of the \verb|sac2c| compiler.
This \verb|sac2c| compiler would allow for the generation of efficient \verb|c|
code, avoiding performance issues caused by use of the Haskell compiler.
In an ideal world, such a port would allow for the correctness properties of my 
FFT definition to be parsed on to the definition built from it in SaC.
This preservation of properties, however, would only truly hold if a verified:
Agda to SaC translator, SaC to \verb|c| compiler, and \verb|c| compiler where 
also used.\cite{ChoosingIsLosing}\cite{BlockedSinkarovs}
In \cite{ChoosingIsLosing}, Šinkarovs and Cockx define method for Agda to Sac 
translation, however, this is not able to ``guarantee that the extracted code 
preservers the semantics of the original implementation''\cite{ChoosingIsLosing}
meaning the above chain loses true verifiability at the first step.
This conversion is not investigated further within this paper, however it would
allow for the generation of efficient \verb|c| kernels, with verifiable cores.
