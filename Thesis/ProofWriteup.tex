%TC:ignore
\begin{code}[hide]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{ProofWriteup}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\end{code}
%TC:endignore
\section{Proof of correctness}\label{sec:proof}
Given the above defintion of the FFT, and our previous definition of the DFT, 
a proof of equality between the two can be formed.

To define the relation between DFT and FFT, pointwise equality \AF{\_≅\_} can 
be used used.
This defines equality between two tensors of shape \AF{s} to hold when
\AF{∀ (i : Position s) → xs i ≡ ys i}.
This allows for proofs to be defined for a general position \AF{i}.

As the DFT operates on the vector form, reshape operations must be used to
flatten the input tensor and unflatten the output for comparison.
Not mentioned previously, is the reindex reshape operation.
Reindex allows for poitions to be cast from \AF{ι n} to \AF{ι m} when \AF{n ≡ m}
without any change in indices.
As the output of the FFT must be read in column major order, it is of the
form \AF{s ᵗ}.
When flattened this gives a tensor of shape \AF{ι (\# s ᵗ)}.
Meanwhile, without the use of reindex, the output of the DFT is of shape
\AF{ι (\# s)}.
Reindexing allows this to be modeled as \AF{ι (\# s ᵗ)}
without reordering the results in this tensor.
This allows for the use of pointwise equality.
\begin{figure}[h]
    \centering
% https://q.uiver.app/#q=WzAsMTEsWzAsMCwiXFxvdmVyYnJhY2V7XFxiZWdpbntwbWF0cml4fSB4XzEgJiB4XzIgXFxcXCB4XzMgJiB4XzQgXFxcXCB4XzUgJiB4XzYgXFxcXCB4XzcgJiB4XzggXFxlbmR7cG1hdHJpeH19XntcXHZlcmJ8c3x9Il0sWzMsMCwiXFxvdmVyYnJhY2V7XFxiZWdpbntwbWF0cml4fSB4XzEgJiB4XzIgJiB4XzMgJiB4XzQgJiB4XzUgJiB4XzYgJiB4XzcgJiB4XzggXFxlbmR7cG1hdHJpeH19XntcXHZlcmJ8bGVuZ3RoIHN8fSJdLFsyLDBdLFswLDQsIiBcXG92ZXJicmFjZXtcXGJlZ2lue3BtYXRyaXh9IFhfMSAmIFhfMiAmIFhfMyAmIFhfNCBcXFxcIFhfNSAmIFhfNiAmIFhfNyAmIFhfOCBcXGVuZHtwbWF0cml4fX1ee1xcdmVyYnxyZWN1cnNpdmUtdHJhbnNwb3NlIHN8fSJdLFsxLDJdLFszLDIsIlxcb3ZlcmJyYWNle1xcYmVnaW57cG1hdHJpeH0gWF8xICYgWF8yICYgWF8zICYgWF80ICYgWF81ICYgWF82ICYgWF83ICYgWF84IFxcZW5ke3BtYXRyaXh9fV57XFx2ZXJifGxlbmd0aCBzfH0iXSxbMywxXSxbMyw0LCJcXGJlZ2lue3BtYXRyaXh9IFhfMSAmIFhfMiBcXFxcIFhfMyAmIFhfNCBcXFxcIFhfNSAmIFhfNiBcXFxcIFhfNyAmIFhfOCBcXGVuZHtwbWF0cml4fSJdLFs3LDAsIlxcb3ZlcmJyYWNle1xcYmVnaW57cG1hdHJpeH0geF8xICYgeF8yICYgeF8zICYgeF80ICYgeF81ICYgeF82ICYgeF83ICYgeF84IFxcZW5ke3BtYXRyaXh9fV57XFx2ZXJifGxlbmd0aCAocmVjdXJzaXZlLXRyYW5zcG9zZSBzKXx9Il0sWzcsMiwiXFxvdmVyYnJhY2V7XFxiZWdpbntwbWF0cml4fSBYXzEgJiBYXzIgJiBYXzMgJiBYXzQgJiBYXzUgJiBYXzYgJiBYXzcgJiBYXzggXFxlbmR7cG1hdHJpeH19XntcXHZlcmJ8bGVuZ3RoIChyZWN1cnNpdmUtdHJhbnNwb3NlIHMpfH0iXSxbNyw0LCIgXFxvdmVyYnJhY2V7XFxiZWdpbntwbWF0cml4fSBYXzEgJiBYXzIgJiBYXzMgJiBYXzQgXFxcXCBYXzUgJiBYXzYgJiBYXzcgJiBYXzggXFxlbmR7cG1hdHJpeH19XntcXHZlcmJ8cmVjdXJzaXZlLXRyYW5zcG9zZSBzfH0iXSxbMCwxLCJcXHZlcmJ8cmVzaGFwZSB8IFxcZmxhdCJdLFswLDMsIlxcdmVyYnxGRlR8IiwyXSxbMSw1LCJcXHZlcmJ8REZUfCJdLFs1LDcsIlxcdmVyYnxyZXNoYXBlIHxcXHNoYXJwIl0sWzMsNywiXFxub3RcXGNvbmcgXFx0ZXh0e2FzIH1cXHZlcmJ8cmVjdXJzaXZlLXRyYW5zcG9zZSBzfCBcXG5vdFxcZXF1aXYgcyIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6ImFycm93aGVhZCJ9LCJib2R5Ijp7Im5hbWUiOiJkb3R0ZWQifX19XSxbMSw4LCJcXHZlcmJ8cmVzaGFwZSAocmVpbmRleCB8fHN8XFxlcXVpdnxzXnR8XFx2ZXJifCl8IiwyXSxbOCw5LCJcXHZlcmJ8REZUfCIsMl0sWzksMTAsIlxcdmVyYnxyZXNoYXBlIHwgXFxzaGFycCIsMl0sWzMsMTAsIlxcY29uZyBcXHRleHR7YXMgfVxcdmVyYnxyZWN1cnNpdmUtdHJhbnNwb3NlIHN8IFxcZXF1aXZcXHZlcmJ8cmVjdXJzaXZlLXRyYW5zcG9zZSBzfFxcdGV4dHsgYW5kIGV2ZXJ5IGVsZW1lbnQgaXMgZXF1YWx9IiwyLHsiY3VydmUiOjUsInN0eWxlIjp7InRhaWwiOnsibmFtZSI6ImFycm93aGVhZCJ9fX1dXQ==
% Made with quiver and then messed with to make it actually work....
\[
\resizebox{\linewidth}{!}{
\begin{tikzcd}[ampersand replacement=\&]
	\begin{array}{c} 
		\overbrace{\begin{pmatrix} x_1 & x_2 \\ x_3 & x_4 \\ x_5 & x_6 \\ x_7 & x_8 \end{pmatrix}}^{\text{\texttt{s}}} 
	\end{array} 
	\&\& {} \& 
	{\overbrace{\begin{pmatrix} x_1 & \cdots & x_8 \end{pmatrix}}^{\text{\texttt{\# s}}}} 
	\&\&\&\& 
	{\overbrace{\begin{pmatrix} x_1 & \cdots & x_8 \end{pmatrix}}^{\text{\texttt{\# (s ᵗ)}}}} 
	\\
	\&\&\& {} \\
	\& {} \&\& 
	{\overbrace{\begin{pmatrix} X_1 & \cdots & X_8 \end{pmatrix}}^{\text{\texttt{\# s}}}} 
	\&\&\&\& 
	{\overbrace{\begin{pmatrix} X_1 & \cdots & X_8 \end{pmatrix}}^{\text{\texttt{\# (s ᵗ)}}}} 
	\\
	\\
	\begin{array}{c}  
		\overbrace{\begin{pmatrix} X_1 & X_2 & X_3 & X_4 \\ X_5 & X_6 & X_7 & X_8 \end{pmatrix}}^{\text{\texttt{s ᵗ}}} 
	\end{array} 
	\&\&\& 
	\begin{array}{c} 
		\begin{pmatrix} X_1 & X_2 \\ X_3 & X_4 \\ X_5 & X_6 \\ X_7 & X_8 \end{pmatrix} 
	\end{array} 
	\&\&\&\& 
	\begin{array}{c}  
		\overbrace{\begin{pmatrix} X_1 & X_2 & X_3 & X_4 \\ X_5 & X_6 & X_7 & X_8 \end{pmatrix}}^{\text{\texttt{s ᵗ}}} 
	\end{array} 
	\\
	{} \& {} \& {} \& {} \& {} \& {} \& {} \& {}  % empty 5th row so references like 5-1 exist
	\arrow["{\texttt{reshape } \flat}", from=1-1, to=1-4]
	\arrow["{\texttt{FFT}}"', from=1-1, to=5-1]
	\arrow["{\texttt{reshape reindex} }", from=1-4, to=1-8]
	\arrow["{\texttt{DFT}}", dotted, from=1-4, to=3-4]
	\arrow["{\texttt{DFT}}"', from=1-8, to=3-8]
	\arrow["{\texttt{reshape } \sharp}", dotted, from=3-4, to=5-4]
	\arrow["{\texttt{reshape } \sharp}"', from=3-8, to=5-8]
	\arrow["{\not\cong \text{ as } \texttt{s ᵗ}~\not\equiv~\texttt{s}}"', dotted, tail reversed, from=5-1, to=5-4]
	\arrow["{\cong \text{ as } \texttt{s ᵗ}~\equiv~\texttt{s ᵗ} \text{ and every element is equal}}"', curve={height=60pt}, tail reversed, from=5-1, to=5-8]
\end{tikzcd}
}
\]
\caption{Diagram showing the effects of reshaping}
\label{fig:reshape_why}
\end{figure}

Using what we now know from the above relation, the proposition for this proof 
describing the relationship between the FFT and DFT can be formed.

%TC:ignore
\begin{code}[hide]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Real}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Real}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Complex}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Cplx}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Algebra.Structures}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{AlgebraStructures}\<%
\\
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Algebra.Definitions}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{AlgebraDefinitions}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Nullary}\<%
\\
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{Eq}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Eq}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{trans}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong-app}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong′}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{icong}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Eq.≡-Reasoning}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Proposition}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{real}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Real}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{cplx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Cplx}\AgdaSpace{}%
\AgdaBound{real}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Real.Real}\AgdaSpace{}%
\AgdaBound{real}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}ᵣ}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ℝ}\AgdaSymbol{)}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}-ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}/\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}/ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*ᵣ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Cplx}\AgdaSpace{}%
\AgdaBound{cplx}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ℂ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{fromℝ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{+-*-isCommutativeRing}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-r₁x-r₁y}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-N-mN}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-N-k₀+k₁}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{AlgebraStructures}%
\>[26]\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{AlgebraDefinitions}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{IsCommutativeRing}\AgdaSpace{}%
\AgdaField{+-*-isCommutativeRing}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-isCommutativeMonoid}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{distribˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{*-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zeroʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zeroˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-assoc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-assoc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-identityˡ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{ℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}≡ᵇ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZero}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+ₙ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{suc-injective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0⇒m≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0⇒n≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZero?}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{*-comm}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-identityʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-assoc}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-assoc}\AgdaSymbol{;}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{+-identityʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{+ₙ-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-zeroˡ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-zeroˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-zeroʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-zeroʳ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Solver}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{+-*-Solver}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{+-*-Solver}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{solve}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:*\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:+\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{con}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:=\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{quotRem}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remQuot}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{quotient}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remainder}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cast}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{fromℕ<}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑ˡ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑ʳ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{join}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{fzero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{fsuc}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cast-is-id}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remQuot-combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt-↑ˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt-↑ʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-↑ˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-↑ʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine-remQuot}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine-surjective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-injective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-cast}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cast-trans}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Bool}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{not}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{T}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Empty}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∃}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{∃₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}×\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{uncurry}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⟨\AgdaUnderscore{},\AgdaUnderscore{}⟩}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}⊎\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{⊤}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Ar}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊗\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{mapLeft}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zipWith}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nest}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{unnest}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{head₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zip}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{iterate}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{ι-cons}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nil}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{length}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAr}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitArₗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitArᵣ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Equality}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≅\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reduce-≅}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁-cong}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{splitArᵣ-zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁-const}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zipWith-congˡ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.NonZero}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{NonZeroₛ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊗\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-s}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroDec}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZeroₛ-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZeroₛ-s⇒¬nonZero-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZero-N⇒PosN-irrelevant}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZero-sᵗ⇒¬nonZero-s}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Sum}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{S}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{S}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{merge-sum}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sum-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sum-swap}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S.sum}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\<%
\\
%
\>[2]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{DISPLAY}\AgdaSpace{}%
\AgdaFunction{S.sum}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaBound{0ℂ}\AgdaSpace{}%
\AgdaBound{+-isCommutativeMonoid}\AgdaSpace{}%
\AgdaPragma{=}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\>[2]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S.sum-cong}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Reshape}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Reshape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{flat}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{recursive-transpose}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{recursive-transposeᵣ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}∙\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊕\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{swap}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{eq}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⟨\AgdaUnderscore{}⟩}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{rev-eq}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{flatten-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{|s|≡|sᵗ|}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reindex-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{recursive-transpose-inv}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\$\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{flip}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘₂\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{FFT}\AgdaSpace{}%
\AgdaBound{real}\AgdaSpace{}%
\AgdaBound{cplx}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{offset-prod}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{twiddles}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{DFT′}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{DFT}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{FFT′}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{FFT}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{private}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{variable}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaGeneralizable{p}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\<%
\\
%
\>[6]\AgdaGeneralizable{N}\AgdaSpace{}%
\AgdaGeneralizable{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
%
\>[2]\AgdaKeyword{infixl}\AgdaSpace{}%
\AgdaNumber{5}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊡\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{trans}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{10}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{length}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{11}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}ᵗ}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}ᵗ}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Shape}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}ᵗ}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{recursive-transpose}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{length}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{length}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{nz-s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{nz-p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-s}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-p}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZeroₛ-sᵗ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{rev-eq-applied}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{rshp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Reshape}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{rshp}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaBound{rshp}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaBound{arr}\<%
\\
%
\>[2]\AgdaFunction{rev-eq-applied}\AgdaSpace{}%
\AgdaBound{rshp}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{rev-eq}\AgdaSpace{}%
\AgdaBound{rshp}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Ar∔}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
%
\>[2]\AgdaFunction{Ar∔}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ar}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{postulate}\<%
\end{code}
%TC:endignore
\begin{AgdaMultiCode}
\begin{code}%
\>[2][@{}l@{\AgdaIndent{1}}]%
\>[4]\AgdaPostulate{fft≅dft}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar∔}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\<%
\end{code}
%TC:ignore
\begin{code}[hide]%
\>[4][@{}l@{\AgdaIndent{1}}]%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\end{code}
%TC:endignore
\begin{code}%
%
\>[6]\AgdaSymbol{→}%
\>[492I]\AgdaFunction{FFT}\AgdaSpace{}%
\AgdaBound{arr}\<%
\\
\>[.][@{}l@{}]\<[492I]%
\>[8]\AgdaOperator{\AgdaFunction{≅}}\<%
\\
%
\>[8]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{DFT}\<%
\\
%
\>[8]\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{s}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSymbol{)))}\AgdaSpace{}%
\AgdaBound{arr}\<%
\end{code}
\end{AgdaMultiCode}

\subsection{Chain of Reasoning}
While the proposition defines what we wish to prove, the chain of reasoning is
used to justify that the proof holds.
The full proof can be found in the attached files, while the most important sections
are discussed here.
It is important to note that as proofs must hold every invariant, at every step
a large amount of complexity is held within this chain of reasoning.
As done previously to hide \AF{NonZero}, as much complexity as possible is hidden 
in the below extracts from the main chain of reasoning as to improve readability.
This complexity remains important, however, as it what allows the strict guarantees 
provided by Agda to hold.
The full proof can be found in the attached files.

Before the chain of reasoning can be defined, some specific syntax must be described
which is used to define this chain of reasoning.

Underscores are used throught the proof to hide complexity when Agda is able to 
automatically infer a value.
This allows for the low level complexity to be hidden while working on high level
aspects of the proof.

\AF{\_≡⟨\_⟩\_} represents one step in a chain of reasoning. 
Therefore \AF{a ≡⟨ p ⟩ b} can be read as "\AF{a} is equivilant to \AF{b}, using the evidence provided 
in \AF{p}", where \AF{p} should be of type \AF{a ≡ b}.

\AF{\_⊡\_} represents the trasnitivity of proofs.
Say we have \AF{p₁ : a ≡ b} and \AF{p₂ : b ≡ c}. \AF{p₁ ⊡ p₂}
would provide evidence that \AF{a ≡ c}.


%TC:ignore
\begin{code}[hide]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Real}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Real}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Complex}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{Cplx}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Algebra.Structures}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{AlgebraStructures}\<%
\\
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Algebra.Definitions}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{AlgebraDefinitions}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Nullary}\<%
\\
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{Eq}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Eq}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{trans}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong-app}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong′}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{icong}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Eq.≡-Reasoning}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Proof}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{real}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Real}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{cplx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Cplx}\AgdaSpace{}%
\AgdaBound{real}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Real.Real}\AgdaSpace{}%
\AgdaBound{real}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}ᵣ}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ℝ}\AgdaSymbol{)}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}-ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}/\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}/ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*ᵣ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Cplx}\AgdaSpace{}%
\AgdaBound{cplx}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ℂ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{fromℝ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{+-*-isCommutativeRing}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-r₁x-r₁y}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-N-mN}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-N-k₀+k₁}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{AlgebraStructures}%
\>[26]\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{AlgebraDefinitions}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{IsCommutativeRing}\AgdaSpace{}%
\AgdaField{+-*-isCommutativeRing}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-isCommutativeMonoid}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{distribˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{*-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zeroʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zeroˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-assoc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-assoc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-identityˡ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{ℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}≡ᵇ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZero}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+ₙ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{suc-injective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0⇒m≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0⇒n≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZero?}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{*-comm}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-identityʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-assoc}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-assoc}\AgdaSymbol{;}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{+-identityʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{+ₙ-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-zeroˡ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-zeroˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-zeroʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-zeroʳ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Solver}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{+-*-Solver}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{+-*-Solver}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{solve}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:*\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:+\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{con}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:=\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{quotRem}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remQuot}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{quotient}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remainder}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cast}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{fromℕ<}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑ˡ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑ʳ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{join}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{fzero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{fsuc}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cast-is-id}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remQuot-combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt-↑ˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt-↑ʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-↑ˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-↑ʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine-remQuot}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine-surjective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-injective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-cast}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cast-trans}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Bool}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{not}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{T}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Empty}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∃}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{∃₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}×\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{uncurry}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⟨\AgdaUnderscore{},\AgdaUnderscore{}⟩}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}⊎\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{⊤}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Ar}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊗\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{mapLeft}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zipWith}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nest}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{unnest}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{head₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zip}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{iterate}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{ι-cons}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nil}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{length}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAr}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitArₗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitArᵣ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Equality}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≅\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reduce-≅}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁-cong}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{splitArᵣ-zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁-const}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zipWith-congˡ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.NonZero}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{NonZeroₛ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊗\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-s}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroDec}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZeroₛ-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZeroₛ-s⇒¬nonZero-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZero-N⇒PosN-irrelevant}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZero-sᵗ⇒¬nonZero-s}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Sum}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{S}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{S}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{merge-sum}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sum-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sum-swap}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S.sum}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\<%
\\
%
\>[2]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{DISPLAY}\AgdaSpace{}%
\AgdaFunction{S.sum}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaBound{0ℂ}\AgdaSpace{}%
\AgdaBound{+-isCommutativeMonoid}\AgdaSpace{}%
\AgdaPragma{=}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\>[2]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S.sum-cong}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Reshape}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Reshape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{flat}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{recursive-transposeᵣ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}∙\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊕\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{swap}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{eq}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⟨\AgdaUnderscore{}⟩}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{rev-eq}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{flatten-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{|s|≡|sᵗ|}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reindex-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{recursive-transpose-inv}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{recursive-transpose}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{\AgdaUnderscore{}ᵗ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\$\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{flip}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘₂\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{FFT}\AgdaSpace{}%
\AgdaBound{real}\AgdaSpace{}%
\AgdaBound{cplx}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{offset-prod}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{twiddles}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{DFT′}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{DFT}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{FFT′}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{FFT}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{Ar∔}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
%
\>[2]\AgdaFunction{Ar∔}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ar}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{private}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{variable}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaGeneralizable{p}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\<%
\\
%
\>[6]\AgdaGeneralizable{N}\AgdaSpace{}%
\AgdaGeneralizable{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{-----------------------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Shorthands\ to\ improve\ readability\ ---}\<%
\\
%
\>[2]\AgdaComment{-----------------------------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{infixl}\AgdaSpace{}%
\AgdaNumber{5}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊡\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{trans}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{10}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{length}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{length}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{length}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{nz-s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{nz-p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-s}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-p}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZeroₛ-sᵗ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{rev-eq-applied}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{rshp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Reshape}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{rshp}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaBound{rshp}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaBound{arr}\<%
\\
%
\>[2]\AgdaFunction{rev-eq-applied}\AgdaSpace{}%
\AgdaBound{rshp}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{rev-eq}\AgdaSpace{}%
\AgdaBound{rshp}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{-------------------------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ 4\ way\ associativity\ helper\ function\ ---}\<%
\\
%
\>[2]\AgdaComment{-------------------------------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{assoc₄}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{d}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{assoc₄}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaKeyword{rewrite}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{*-assoc}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{c}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{*-assoc}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{d}\<%
\\
%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{--------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Properties\ of\ iota\ ---}\<%
\\
%
\>[2]\AgdaComment{--------------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{M}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaBound{prf}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{i}\<%
\\
%
\>[2]\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{iota-split}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaSymbol{(}\AgdaBound{k₀}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSymbol{)))}\<%
\\
%
\>[5]\AgdaSymbol{(}\AgdaBound{k₁}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSymbol{)))}\<%
\\
%
\>[5]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₀}\<%
\\
%
\>[2]\AgdaFunction{iota-split}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{toℕ-combine}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{-----------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Congurance\ properties\ ---}\<%
\\
%
\>[2]\AgdaComment{-----------------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{prfₗ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{j}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-n}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-m}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaBound{j}\<%
\\
%
\>[2]\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{DFT-cong}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaBound{ys}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-N}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaBound{ys}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{DFT}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaFunction{DFT}\AgdaSpace{}%
\AgdaBound{ys}\<%
\\
%
\>[2]\AgdaFunction{DFT-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-N}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{prf}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{FFT-cong}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaBound{ys}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZeroₛ-s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaBound{ys}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{FFT}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaFunction{FFT}\AgdaSpace{}%
\AgdaBound{ys}\<%
\\
%
\>[2]\AgdaFunction{FFT-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{nonZero-N}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{DFT-cong}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-N}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[2]\AgdaFunction{FFT-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{nonZero-r₂}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaKeyword{instance}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaBound{r₁}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{nonZero-r₁}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaBound{r₂}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{nonZero-r₂}\<%
\\
%
\>[4]\AgdaKeyword{in}%
\>[8]\AgdaSymbol{(}\AgdaFunction{FFT-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{λ\{}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{((}\AgdaFunction{FFT-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{λ\{}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaBound{j₁}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{-------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Properties\ of\ Sum\ ---}\<%
\\
%
\>[2]\AgdaComment{-------------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{--\ Of\ note\ here\ is\ that\ I\ cannot\ put\ this\ in\ the\ sum\ module\ as\ it\ requires\ knowledge\ of\ \AgdaUnderscore{}+\AgdaUnderscore{}\ as\ well\ as\ its\ relation\ with\ \AgdaUnderscore{}*\AgdaUnderscore{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{*-distribˡ-sum}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{*-distribˡ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{zeroʳ}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[2]\AgdaFunction{*-distribˡ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaKeyword{rewrite}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{distribˡ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaInductiveConstructor{fzero}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{tail₁}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{))}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{*-distribˡ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{tail₁}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ\{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{\}))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{*-distribʳ-sum}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}*}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{*-distribʳ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaKeyword{rewrite}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{*-comm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{*-distribˡ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{*-comm}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xs}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{------------------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Rearanging\ of\ roots\ of\ unity\ ---}\<%
\\
%
\>[2]\AgdaComment{------------------------------------}\<%
\\
%
\>[2]\AgdaFunction{cooley-tukey-derivation}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-r₁}%
\>[21]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-r₂}%
\>[21]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[4]\AgdaSymbol{→}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaField{-ω}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[16]\AgdaSymbol{(}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
%
\>[18]\AgdaOperator{\AgdaPrimitive{*ₙ}}\<%
\\
%
\>[18]\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{cooley-tukey-derivation}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-r₂}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{rearrange-ω-power}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{split-ω}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{remove-constant-term}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{simplify-bases}\<%
\\
%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{instance}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\<%
\\
%
\>[8]\AgdaFunction{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\<%
\\
%
\>[6]\AgdaFunction{simplify-bases}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{simplify-bases}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{cong₂}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
%
\>[12]\AgdaSymbol{(}%
\>[1486I]\AgdaFunction{cong₂}\<%
\\
\>[1486I][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
%
\>[18]\AgdaSymbol{(}\AgdaField{ω-r₁x-r₁y}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
%
\>[18]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}%
\>[16]\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{*ₙ-comm}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ω-r₁x-r₁y}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{remove-constant-term}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{remove-constant-term}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ω-N-mN}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{\})}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{*-identityʳ}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[6]\AgdaFunction{rearrange-ω-power}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}%
\>[15]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
\>[0]\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{rearrange-ω-power}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{-ω-cong₂}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{solve}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaNumber{6}\<%
\\
%
\>[12]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{r₁ℕ}\AgdaSpace{}%
\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaBound{k₀ℕ}\AgdaSpace{}%
\AgdaBound{k₁ℕ}\AgdaSpace{}%
\AgdaBound{j₀ℕ}\AgdaSpace{}%
\AgdaBound{j₁ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{k₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{k₀ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{j₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{j₀ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:=}}\AgdaSpace{}%
\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{j₀ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{k₀ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{j₀ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{r₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{j₁ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{k₁ℕ}\AgdaSymbol{)))}\<%
\\
%
\>[12]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[12]\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{j₁}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{split-ω}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{split-ω}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaField{ω-N-k₀+k₁}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))\}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{flip}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{*ₙ-assoc}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ω-N-k₀+k₁}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}%
\>[83]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}%
\>[110]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaFunction{⊡}}%
\>[1830I]\AgdaSymbol{(}\AgdaFunction{flip}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[.][@{}l@{}]\<[1830I]%
\>[12]\AgdaSymbol{(}\AgdaField{ω-N-k₀+k₁}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}%
\>[83]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}%
\>[110]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{cooley-tukey-derivation-application}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaSymbol{(}\AgdaBound{j₁}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{))}\<%
\\
%
\>[5]\AgdaSymbol{(}\AgdaBound{j₀}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{))}\<%
\\
%
\>[5]\AgdaSymbol{(}\AgdaBound{k₀}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)))}\<%
\\
%
\>[5]\AgdaSymbol{(}\AgdaBound{k₁}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)))}\<%
\\
%
\>[5]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{nz-r₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSymbol{)}\<%
\\
%
\>[5]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{nz-r₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSymbol{)}\<%
\\
%
\>[5]\AgdaSymbol{→}\<%
\\
\>[5][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
\>[5][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaField{*}}%
\>[1887I]\AgdaField{-ω}\<%
\\
\>[1887I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{♭}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaOperator{\AgdaField{*}}%
\>[1930I]\AgdaField{-ω}\<%
\\
\>[1930I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{r₁}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaFunction{cooley-tukey-derivation-application}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaKeyword{instance}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-r₁}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-r₂}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaKeyword{in}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{begin}}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}%
\>[2076I]\AgdaFunction{≡⟨}%
\>[10]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}%
\>[2078I]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
\>[2078I][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[16]\AgdaSymbol{(}%
\>[2080I]\AgdaFunction{-ω-cong₂}\<%
\\
\>[2080I][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[20]\AgdaSymbol{(}%
\>[2086I]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\<%
\\
\>[2086I][@{}l@{\AgdaIndent{0}}]%
\>[24]\AgdaSymbol{(}%
\>[2088I]\AgdaSymbol{(}\AgdaFunction{cong}\<%
\\
\>[2088I][@{}l@{\AgdaIndent{0}}]%
\>[30]\AgdaFunction{iota}\<%
\\
%
\>[30]\AgdaSymbol{(}\AgdaFunction{rev-eq}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[2088I]%
\>[26]\AgdaSymbol{)}\<%
\\
%
\>[24]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}))}\<%
\\
%
\>[24]\AgdaSymbol{)}\<%
\\
%
\>[24]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[20]\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaInductiveConstructor{refl}\<%
\\
\>[.][@{}l@{}]\<[2076I]%
\>[6]\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}%
\>[2100I]\AgdaFunction{≡⟨}%
\>[2101I]\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cooley-tukey-derivation}\<%
\\
\>[2101I][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[2101I]%
\>[9]\AgdaSymbol{)}\<%
\\
\>[2100I][@{}l@{\AgdaIndent{0}}]%
\>[7]\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{≡⟨}%
\>[2120I]\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[2120I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)))}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ\AgdaUnderscore{}}}\AgdaSymbol{))}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaSymbol{(}\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}))}\<%
\\
%
\>[14]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
\>[2120I][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{≡⟨}%
\>[2151I]\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[2151I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)))}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\})))}\<%
\\
%
\>[14]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
\>[2151I][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+ₙ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}%
\>[2209I]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{sym}%
\>[2211I]\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[2211I][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaSymbol{(}\AgdaFunction{iota-split}\<%
\\
\>[20][@{}l@{\AgdaIndent{0}}]%
\>[22]\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}}\<%
\\
%
\>[22]\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\}}\<%
\\
%
\>[22]\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
%
\>[22]\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
%
\>[20]\AgdaSymbol{)}\<%
\\
%
\>[20]\AgdaSymbol{(}\AgdaFunction{iota-split}\<%
\\
\>[20][@{}l@{\AgdaIndent{0}}]%
\>[22]\AgdaSymbol{\{}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)\}}\<%
\\
%
\>[22]\AgdaSymbol{\{}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)\}}\<%
\\
%
\>[22]\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
%
\>[22]\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
%
\>[20]\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{)}\<%
\\
\>[2211I][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{)}\<%
\\
\>[2209I][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∎}}\<%
\\
\>[0]\<%
\\
%
\>[2]\AgdaComment{-----------------}\<%
\\
%
\>[2]\AgdaComment{---\ FFT\ ≡\ DFT\ ---}\<%
\\
%
\>[2]\AgdaComment{-----------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{fft≅dft}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nz-s}%
\>[14]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar∔}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}%
\>[2250I]\AgdaFunction{FFT}\AgdaSpace{}%
\AgdaBound{arr}\<%
\\
\>[.][@{}l@{}]\<[2250I]%
\>[6]\AgdaOperator{\AgdaFunction{≅}}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{DFT}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaFunction{flatten-reindex}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{arr}\<%
\end{code}
%TC:endignore
\subsubsection{Inductive Step}
The main proof is built inductively on the case of a one dimensional tensor, 
and a multi multi dimensional tensor.
This allows my proof to match the shape of the \AF{FFT} definition.

\begin{AgdaMultiCode}
\begin{code}[number=code:fft′≡dft′-ιN]%
%
\>[2]\AgdaFunction{fft≅dft}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{nz-N}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\end{code}
\begin{code}[number=code:fft′≡dft′-r₁⊗r₂]%
%
\>[2]\AgdaFunction{fft≅dft}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\end{code}
%TC:ignore
\begin{code}[hide]%
\>[2][@{}l@{\AgdaIndent{1}}]%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaKeyword{instance}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaBound{r₁}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{nz-r₁}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaBound{r₂}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{nz-r₂}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}%
\>[26]\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaKeyword{in}\<%
\end{code}
%TC:endignore
These first two lines of this chain of reasoning split the proof on the shape 
of the input tensor.
\ref{code:fft′≡dft′-ιN} pattern matches the case where the shape is one dimensional, 
as FFT on such a shape is equal by definition to the DFT, no chain of reasoning 
is required to prove this case.
This is the base case of the induction.
\ref{code:fft′≡dft′-r₁⊗r₂} pattern matches on the alternate case, and precedes 
the remainder of the proof, where \AF{r₁} and \AF{r₂} represent the left and right
sub shapes.

\begin{code}%
\>[4][@{}l@{\AgdaIndent{1}}]%
\>[6]\AgdaOperator{\AgdaFunction{begin}}\<%
\end{code}
\begin{code}[number=code:fft′≡dft′-lhs]%
\>[6][@{}l@{\AgdaIndent{1}}]%
\>[8]\AgdaFunction{FFT}%
\>[2361I]\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2361I]%
\>[12]\AgdaFunction{FFT}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[8]\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{j₁}\<%
\end{code}
\begin{code}[number=code:fft′≡dft′-inductive-step-1]%
%
\>[6]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{fft≅dft}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{DFT}%
\>[2378I]\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2378I]%
\>[12]\AgdaFunction{FFT}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[8]\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\end{code}
\begin{code}[number=code:fft′≡dft′-inductive-step-2]%
%
\>[6]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{DFT-cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fft≅dft}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{DFT}%
\>[2412I]\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2412I]%
\>[12]\AgdaFunction{DFT}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[8]\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaComment{--\ ...}\<%
\end{code}
Splitting upon the shape allows the left hand side to take 
the form shown in step \ref{code:fft′≡dft′-lhs}.
Step \ref{code:fft′≡dft′-inductive-step-1} and \ref{code:fft′≡dft′-inductive-step-2}
are then able to apply the proposition currently being proven to the outer and
inner instances of FFT.
This allows both instances to be represented as DFT, which in turn allows for
the representation of the left hand side in sum form.
\begin{code}%
%
\>[6]\AgdaFunction{≡⟨⟩}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{sum}%
\>[2435I]\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2435I]%
\>[12]\AgdaFunction{sum}%
\>[2441I]\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2441I]%
\>[16]\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaOperator{\AgdaField{*}}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}%
\>[46]\AgdaComment{--\ Inner\ DFT\ -ω}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}%
\>[46]\AgdaComment{--\ Twiddle\ Factor\ -ω}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}%
\>[46]\AgdaComment{--\ Outer\ DFT\ -ω}\<%
\\
%
\>[8]\AgdaSymbol{)}\<%
\end{code}
%TC:ignore
\begin{code}[hide]%
%
\>[8]\AgdaFunction{≡⟨}%
\>[12]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}%
\>[24]\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(λ}%
\>[2458I]\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[2458I][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{*-distribʳ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{*-distribʳ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[16]\AgdaOperator{\AgdaFunction{⊡}}%
\>[2472I]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[2472I][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaSymbol{(λ}%
\>[2477I]\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[2477I][@{}l@{\AgdaIndent{0}}]%
\>[24]\AgdaFunction{assoc₄}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[20][@{}l@{\AgdaIndent{0}}]%
\>[22]\AgdaOperator{\AgdaFunction{⊡}}%
\>[2483I]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
\>[2483I][@{}l@{\AgdaIndent{0}}]%
\>[26]\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{rev-eq-applied}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊕}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})))}\<%
\\
%
\>[26]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[20]\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaSymbol{)}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{⟩}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}%
\>[2495I]\AgdaFunction{≡⟨}%
\>[12]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}%
\>[24]\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaSymbol{(}\AgdaFunction{cooley-tukey-derivation-application}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
\>[2495I][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{⟩}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}%
\>[2518I]\AgdaFunction{≡⟨}%
\>[12]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\})))}\<%
\\
\>[2518I][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}))}\<%
\\
\>[2518I][@{}l@{\AgdaIndent{0}}]%
\>[9]\AgdaFunction{⟩}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}%
\>[2533I]\AgdaFunction{≡⟨}%
\>[12]\AgdaFunction{sum-swap}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[2533I][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{merge-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[2533I][@{}l@{\AgdaIndent{0}}]%
\>[9]\AgdaFunction{⟩}\<%
\\
\>[9][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(λ}%
\>[2551I]\AgdaBound{k}%
\>[2552I]\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[2552I]%
\>[19]\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{flat}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊕}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2551I]%
\>[17]\AgdaOperator{\AgdaField{*}}\<%
\\
\>[17][@{}l@{\AgdaIndent{0}}]%
\>[19]\AgdaField{-ω}\<%
\\
\>[19][@{}l@{\AgdaIndent{0}}]%
\>[21]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[21]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
%
\>[14]\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[2533I]%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{sum-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{sum-cong}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\<%
\\
%
\>[10]\AgdaSymbol{(λ}%
\>[2602I]\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[2602I][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[16]\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[18]\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\}))}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{⟩}\<%
\\
%
\>[8]\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{DFT}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaFunction{flatten-reindex}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\end{code}
%TC:endignore
\end{AgdaMultiCode}
\subsubsection{Cooley Tukey Derivation}
%TC:ignore
\begin{code}[hide]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{ct-derivation}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{real}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Real}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{cplx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Cplx}\AgdaSpace{}%
\AgdaBound{real}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Real.Real}\AgdaSpace{}%
\AgdaBound{real}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}ᵣ}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ℝ}\AgdaSymbol{)}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}-ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}/\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}/ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*ᵣ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Cplx}\AgdaSpace{}%
\AgdaBound{cplx}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ℂ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{fromℝ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{+-*-isCommutativeRing}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-r₁x-r₁y}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-N-mN}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-N-k₀+k₁}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{AlgebraStructures}%
\>[26]\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{AlgebraDefinitions}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{IsCommutativeRing}\AgdaSpace{}%
\AgdaField{+-*-isCommutativeRing}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-isCommutativeMonoid}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{distribˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{*-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zeroʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zeroˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-assoc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-assoc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-identityˡ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{ℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}≡ᵇ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZero}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+ₙ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{suc-injective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0⇒m≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0⇒n≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZero?}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{*-comm}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-identityʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-assoc}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-assoc}\AgdaSymbol{;}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{+-identityʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{+ₙ-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-zeroˡ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-zeroˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-zeroʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-zeroʳ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Solver}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{+-*-Solver}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{+-*-Solver}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{solve}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:*\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:+\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{con}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:=\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{quotRem}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remQuot}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{quotient}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remainder}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cast}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{fromℕ<}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑ˡ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑ʳ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{join}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{fzero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{fsuc}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cast-is-id}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remQuot-combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt-↑ˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt-↑ʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-↑ˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-↑ʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine-remQuot}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine-surjective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-injective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-cast}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cast-trans}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Bool}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{not}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{T}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Empty}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∃}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{∃₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}×\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{uncurry}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⟨\AgdaUnderscore{},\AgdaUnderscore{}⟩}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}⊎\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{⊤}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Ar}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊗\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{mapLeft}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zipWith}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nest}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{unnest}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{head₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zip}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{iterate}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{ι-cons}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nil}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{length}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAr}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitArₗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitArᵣ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Equality}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≅\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reduce-≅}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁-cong}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{splitArᵣ-zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁-const}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zipWith-congˡ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.NonZero}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{NonZeroₛ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊗\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-s}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroDec}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZeroₛ-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZeroₛ-s⇒¬nonZero-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZero-N⇒PosN-irrelevant}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZero-sᵗ⇒¬nonZero-s}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Sum}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{S}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{S}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{merge-sum}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sum-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sum-swap}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S.sum}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\<%
\\
%
\>[2]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{DISPLAY}\AgdaSpace{}%
\AgdaFunction{S.sum}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaBound{0ℂ}\AgdaSpace{}%
\AgdaBound{+-isCommutativeMonoid}\AgdaSpace{}%
\AgdaPragma{=}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\>[2]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S.sum-cong}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Reshape}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Reshape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{flat}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{recursive-transpose}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{recursive-transposeᵣ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}∙\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊕\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{swap}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{eq}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⟨\AgdaUnderscore{}⟩}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{rev-eq}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{flatten-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{|s|≡|sᵗ|}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reindex-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{recursive-transpose-inv}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\$\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{flip}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘₂\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{FFT}\AgdaSpace{}%
\AgdaBound{real}\AgdaSpace{}%
\AgdaBound{cplx}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{offset-prod}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{twiddles}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{DFT′}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{DFT}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{FFT′}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{FFT}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{private}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{variable}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaGeneralizable{p}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\<%
\\
%
\>[6]\AgdaGeneralizable{N}\AgdaSpace{}%
\AgdaGeneralizable{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{-----------------------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Shorthands\ to\ improve\ readability\ ---}\<%
\\
%
\>[2]\AgdaComment{-----------------------------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{infixl}\AgdaSpace{}%
\AgdaNumber{5}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊡\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{trans}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{10}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{length}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{11}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}ᵗ}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}ᵗ}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{Shape}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}ᵗ}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{recursive-transpose}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{length}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{length}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{nz-s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{nz-p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-s}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-p}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{prfₗ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{j}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-n}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-m}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaBound{j}\<%
\\
%
\>[2]\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[0]\<%
\end{code}
%TC:endignore
Using the rule that $c\times\sum_{i=0}^n{x_i}\equiv\sum_{i=0}^n{cx_i}$, the two
instances of \AF{-ω} in the outer sum, can be moved into the inner sum.
With all instances of \AF{-ω} gathered, the rules of the roots of unity can be
used, following the inverse of the initial Cooley Tukey derivation, to represent 
all roots of unity as one.
% \ref{sec:complex_numbers}

As the main logic of this step considers positions as natural numbers,
we can define the body of the proof as a lemma on six natural numbers. 
By providing concrete values for each of these numbers, this lemma can then be 
applied in the main proof.

\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[2]\AgdaFunction{cooley-tukey-derivation}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{nonZero-r₁}%
\>[22]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{\}\}}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{nonZero-r₂}%
\>[22]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaSymbol{\}\}}\<%
\\
%
\>[4]\AgdaSymbol{→}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaField{-ω}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{\}\}}\<%
\\
%
\>[16]\AgdaSymbol{(}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
%
\>[18]\AgdaOperator{\AgdaPrimitive{*ₙ}}\<%
\\
%
\>[18]\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{cooley-tukey-derivation}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{nonZero-r₁}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{nonZero-r₂}\AgdaSpace{}%
\AgdaSymbol{\}\}}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{=}%
\>[3132I]\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[3132I][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaField{-ω}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[3132I]%
\>[6]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{rearrange-ω-power}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaField{-ω}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}%
\>[15]\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{≡⟨}%
\>[3170I]\AgdaFunction{split-ω}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[3170I][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[3170I]%
\>[9]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[9]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{≡⟨}%
\>[3207I]\AgdaFunction{remove-constant-term}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[3207I][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[3207I]%
\>[9]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{≡⟨}%
\>[3233I]\AgdaFunction{simplify-bases}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
\>[3233I][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaField{-ω}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[3233I]%
\>[9]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\end{code}
%TC:ignore
\begin{code}[hide]%
%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{instance}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\<%
\\
%
\>[8]\AgdaFunction{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\<%
\end{code}
%TC:endignore

It can clearly be seen that the above lemma has four distinct steps.

\paragraph{Rearrange Power} \AF{rearrange-ω-power} expands the second term of -ω, and rearanges the result
such that $r₂$ then $r₁$ are the rightmost elements.
With standard Agda methods, this would require a large chain of reasoning,
where each set could apply one property on the natural numbers.
Instead, the \verb|solver| for natural numbers can be used.
Natural numbers, addition, and multiplication form an algebraic structure called
a Commutative Ring.
To form this structure a set of properties on the number type must hold, this set
of properties includes commutativity, associativity and the distributive property
of multiplication over addition.
The \verb|solver| method
is able to utilise these properties to form chains of reasoning automatically.
This simplifies what would otherwise be a long, strict proof while maintaining
all correctness properties.

%TC:ignore
\begin{code}[hide]%
%
\>[6]\AgdaFunction{rearrange-ω-power}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}%
\>[15]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
\>[0]\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}%
\>[15]\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}%
\>[29]\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}%
\>[22]\AgdaBound{j₀}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}%
\>[29]\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\end{code}
%TC:endignore

\begin{code}%
%
\>[6]\AgdaFunction{rearrange-ω-power}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{-ω-cong₂}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{solve}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaNumber{6}\<%
\\
%
\>[12]\AgdaSymbol{(λ}%
\>[3300I]\AgdaBound{r₁ℕ}%
\>[3301I]\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaBound{k₀ℕ}\AgdaSpace{}%
\AgdaBound{k₁ℕ}\AgdaSpace{}%
\AgdaBound{j₀ℕ}\AgdaSpace{}%
\AgdaBound{j₁ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[3301I][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaSymbol{(}\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{k₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{k₀ℕ}\AgdaSymbol{)}\<%
\\
\>[3300I][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaOperator{\AgdaFunction{:*}}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaSymbol{(}\AgdaBound{r₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{j₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{j₀ℕ}\AgdaSymbol{)}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaOperator{\AgdaFunction{:=}}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}%
\>[36]\AgdaBound{j₀ℕ}\AgdaSymbol{)}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaOperator{\AgdaFunction{:+}}%
\>[20]\AgdaBound{k₀ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}%
\>[28]\AgdaBound{j₀ℕ}\<%
\\
%
\>[16]\AgdaOperator{\AgdaFunction{:+}}%
\>[20]\AgdaBound{r₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}%
\>[36]\AgdaBound{j₁ℕ}\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaOperator{\AgdaFunction{:+}}%
\>[20]\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{k₁ℕ}\AgdaSymbol{)))}\<%
\\
%
\>[12]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[12]\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{j₁}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\end{code}
As ring is defined generally, a special syntax must be used to describe the
lemma to solve.

\paragraph{Split ω} \AF{split-ω} applies \AF{ω-N-k₀+k₁}, which defines that
$-ω_{N}^{k₀ + k₁}\equiv -ω_{N}^{k₀} + -ω_{N}^{k₁}$.
This breaks down the current large power of the root of unity, into four 
smaller roots of utranspose nity.

%TC:ignore
\begin{code}[hide]%
%
\>[6]\AgdaFunction{split-ω}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{split-ω}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaField{ω-N-k₀+k₁}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))\}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{flip}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{*ₙ-assoc}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ω-N-k₀+k₁}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}%
\>[83]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}%
\>[110]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaFunction{⊡}}%
\>[3472I]\AgdaSymbol{(}\AgdaFunction{flip}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[.][@{}l@{}]\<[3472I]%
\>[12]\AgdaSymbol{(}\AgdaField{ω-N-k₀+k₁}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}%
\>[83]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}%
\>[110]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\end{code}
%TC:endignore

\paragraph{Remove Constant Term} \AF{remove-constant-term} applies \AF{ω-N-mN}, which states that $-ω_N^{Nm}\equiv 1$,
to remove the last root of unity $-ω_{r₂r₁}^{(r₂r₁)(j₁k₁)}$.

%TC:ignore
\begin{code}[hide]%
%
\>[6]\AgdaFunction{remove-constant-term}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{remove-constant-term}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ω-N-mN}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{\})}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{*-identityʳ}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\end{code}
%TC:endignore

\paragraph{Simplify Bases} \AF{simplify-bases} applies \AF{ω-r₁x-r₁y}, which states that $ -ω_{r₁x}^{r₁y}  ≡ -ω_x^y $,
to eliminate r₂ or r₁ when they appear in both the power and the base.

%TC:ignore
\begin{code}[hide]%
%
\>[6]\AgdaFunction{simplify-bases}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{simplify-bases}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{cong₂}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
%
\>[12]\AgdaSymbol{(}%
\>[3658I]\AgdaFunction{cong₂}\<%
\\
\>[3658I][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
%
\>[18]\AgdaSymbol{(}\AgdaField{ω-r₁x-r₁y}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
%
\>[18]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}%
\>[16]\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{*ₙ-comm}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ω-r₁x-r₁y}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\end{code}
%TC:endignore

\subsubsection{Nesting of Sums}

With the inverse of the above derivation applied to the current chain of reasoning, 
the left hand side (from the FFT) takes the form of a nested sum with only one 
root of unity.

\begin{AgdaMultiCode}
%TC:ignore
\begin{code}[hide]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{ProofTwo}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{real}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Real}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{cplx}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Cplx}\AgdaSpace{}%
\AgdaBound{real}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Real.Real}\AgdaSpace{}%
\AgdaBound{real}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}ᵣ}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ℝ}\AgdaSymbol{)}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}-ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{-ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}/\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}/ᵣ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*ᵣ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Cplx}\AgdaSpace{}%
\AgdaBound{cplx}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ℂ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{fromℝ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{+-*-isCommutativeRing}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-r₁x-r₁y}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-N-mN}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{ω-N-k₀+k₁}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{AlgebraStructures}%
\>[26]\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{AlgebraDefinitions}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{IsCommutativeRing}\AgdaSpace{}%
\AgdaField{+-*-isCommutativeRing}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{+-isCommutativeMonoid}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{distribˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{*-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zeroʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zeroˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-assoc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-assoc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{+-identityˡ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{ℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}≡ᵇ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZero}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+ₙ\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{suc-injective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0⇒m≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{m*n≢0⇒n≢0}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZero?}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{*-comm}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-comm}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-identityʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-assoc}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-assoc}\AgdaSymbol{;}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{+-identityʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{+ₙ-identityʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-zeroˡ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-zeroˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{*-zeroʳ}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{*ₙ-zeroʳ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Solver}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{+-*-Solver}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{+-*-Solver}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{solve}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:*\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:+\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{con}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}:=\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{quotRem}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remQuot}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{quotient}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remainder}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cast}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{fromℕ<}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑ˡ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}↑ʳ\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{join}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{fzero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{fsuc}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cast-is-id}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{remQuot-combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt-↑ˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAt-↑ʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-↑ˡ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-↑ʳ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-combine}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine-remQuot}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{combine-surjective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-injective}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{toℕ-cast}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cast-trans}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Bool}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{true}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{false}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{not}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Bool}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{T}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Empty}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{∃}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{∃₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}×\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{uncurry}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{},\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⟨\AgdaUnderscore{},\AgdaUnderscore{}⟩}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Sum.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{inj₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{inj₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}⊎\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Unit}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{⊤}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{tt}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Ar}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊗\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{mapLeft}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zipWith}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nest}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{unnest}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{head₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zip}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{iterate}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{ι-cons}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nil}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{length}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitAr}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitArₗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitArᵣ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Equality}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≅\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reduce-≅}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁-cong}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{splitArᵣ-zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁-const}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{zipWith-congˡ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.NonZero}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{NonZeroₛ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊗\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-s}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroDec}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZeroₛ-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZeroₛ-s⇒¬nonZero-sᵗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZero-N⇒PosN-irrelevant}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{¬nonZero-sᵗ⇒¬nonZero-s}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Sum}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{S}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{S}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{merge-sum}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sum-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sum-swap}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S.sum}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\<%
\\
%
\>[2]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{DISPLAY}\AgdaSpace{}%
\AgdaFunction{S.sum}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaBound{0ℂ}\AgdaSpace{}%
\AgdaBound{+-isCommutativeMonoid}\AgdaSpace{}%
\AgdaPragma{=}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\>[2]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S.sum-cong}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaFunction{0ℂ}\AgdaSpace{}%
\AgdaFunction{+-isCommutativeMonoid}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Reshape}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Reshape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{flat}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{recursive-transposeᵣ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}∙\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊕\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{swap}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{eq}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⟨\AgdaUnderscore{}⟩}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{rev-eq}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{flatten-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{|s|≡|sᵗ|}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reindex-reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{recursive-transpose-inv}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{recursive-transpose}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{\AgdaUnderscore{}ᵗ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\$\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{id}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{flip}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘₂\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{FFT}\AgdaSpace{}%
\AgdaBound{real}\AgdaSpace{}%
\AgdaBound{cplx}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{offset-prod}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{twiddles}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{DFT′}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{DFT}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{FFT′}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{FFT}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{private}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{variable}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaGeneralizable{p}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\<%
\\
%
\>[6]\AgdaGeneralizable{N}\AgdaSpace{}%
\AgdaGeneralizable{M}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{-----------------------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Shorthands\ to\ improve\ readability\ ---}\<%
\\
%
\>[2]\AgdaComment{-----------------------------------------}\<%
\\
%
\>[2]\AgdaFunction{Ar∔}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitive{Set}\<%
\\
%
\>[2]\AgdaFunction{Ar∔}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{Ar}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{infixl}\AgdaSpace{}%
\AgdaNumber{5}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊡\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⊡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{trans}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{infix}\AgdaSpace{}%
\AgdaNumber{10}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
%
\>[2]\AgdaOperator{\AgdaFunction{\#\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{length}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{length}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZero-s}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{length}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[2]\AgdaFunction{nz-ι\#}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{nz-s}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{nz-p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{p}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-s}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-p}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nonZeroₛ-s⇒nonZeroₛ-sᵗ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{rev-eq-applied}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{rshp}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Reshape}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{rshp}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaBound{rshp}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaBound{arr}\<%
\\
%
\>[2]\AgdaFunction{rev-eq-applied}\AgdaSpace{}%
\AgdaBound{rshp}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{rev-eq}\AgdaSpace{}%
\AgdaBound{rshp}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{-------------------------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ 4\ way\ associativity\ helper\ function\ ---}\<%
\\
%
\>[2]\AgdaComment{-------------------------------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{assoc₄}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{d}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{assoc₄}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{c}\AgdaSpace{}%
\AgdaBound{d}\AgdaSpace{}%
\AgdaKeyword{rewrite}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{*-assoc}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaBound{b}\AgdaSpace{}%
\AgdaBound{c}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{*-assoc}\AgdaSpace{}%
\AgdaBound{a}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{b}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{c}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{d}\<%
\\
%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{--------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Properties\ of\ iota\ ---}\<%
\\
%
\>[2]\AgdaComment{--------------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{M}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{i}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaBound{prf}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{i}\<%
\\
%
\>[2]\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{iota-split}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaSymbol{(}\AgdaBound{k₀}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSymbol{)))}\<%
\\
%
\>[5]\AgdaSymbol{(}\AgdaBound{k₁}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSymbol{)))}\<%
\\
%
\>[5]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₀}\<%
\\
%
\>[2]\AgdaFunction{iota-split}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{rewrite}\AgdaSpace{}%
\AgdaFunction{toℕ-combine}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{-----------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Congurance\ properties\ ---}\<%
\\
%
\>[2]\AgdaComment{-----------------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k}\AgdaSpace{}%
\AgdaBound{j}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{prfₗ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{j}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-n}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-m}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaBound{j}\<%
\\
%
\>[2]\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{DFT-cong}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaBound{ys}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-N}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaBound{ys}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{DFT}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaFunction{DFT}\AgdaSpace{}%
\AgdaBound{ys}\<%
\\
%
\>[2]\AgdaFunction{DFT-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-N}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{j}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{prf}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{FFT-cong}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Shape}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaBound{ys}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZeroₛ-s}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaBound{s}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaBound{ys}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{FFT}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaFunction{FFT}\AgdaSpace{}%
\AgdaBound{ys}\<%
\\
%
\>[2]\AgdaFunction{FFT-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{nonZero-N}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{DFT-cong}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-N}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[2]\AgdaFunction{FFT-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{nonZero-r₂}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaKeyword{instance}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaBound{r₁}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{nonZero-r₁}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaBound{r₂}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{nonZero-r₂}\<%
\\
%
\>[4]\AgdaKeyword{in}%
\>[8]\AgdaSymbol{(}\AgdaFunction{FFT-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{λ\{}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{((}\AgdaFunction{FFT-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{λ\{}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaBound{j₁}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{-------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Properties\ of\ Sum\ ---}\<%
\\
%
\>[2]\AgdaComment{-------------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{--\ Of\ note\ here\ is\ that\ I\ cannot\ put\ this\ in\ the\ sum\ module\ as\ it\ requires\ knowledge\ of\ \AgdaUnderscore{}+\AgdaUnderscore{}\ as\ well\ as\ its\ relation\ with\ \AgdaUnderscore{}*\AgdaUnderscore{}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{*-distribˡ-sum}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{*-distribˡ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{zeroʳ}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[2]\AgdaFunction{*-distribˡ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaKeyword{rewrite}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{distribˡ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaInductiveConstructor{fzero}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{tail₁}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{))}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{*-distribˡ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaFunction{tail₁}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ\{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{\}))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{*-distribʳ-sum}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaGeneralizable{N}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaField{\AgdaUnderscore{}*}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{*-distribʳ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaKeyword{rewrite}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaFunction{*-comm}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{|}\AgdaSpace{}%
\AgdaFunction{*-distribˡ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{λ}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{*-comm}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xs}\AgdaSpace{}%
\AgdaBound{i}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{------------------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Rearanging\ of\ roots\ of\ unity\ ---}\<%
\\
%
\>[2]\AgdaComment{------------------------------------}\<%
\\
%
\>[2]\AgdaFunction{cooley-tukey-derivation}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-r₁}%
\>[21]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-r₂}%
\>[21]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[4]\AgdaSymbol{→}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaField{-ω}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[16]\AgdaSymbol{(}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
%
\>[18]\AgdaOperator{\AgdaPrimitive{*ₙ}}\<%
\\
%
\>[18]\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{cooley-tukey-derivation}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nonZero-r₂}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{rearrange-ω-power}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{split-ω}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{remove-constant-term}\<%
\\
%
\>[4]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{simplify-bases}\<%
\\
%
\>[4]\AgdaKeyword{where}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaKeyword{instance}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\<%
\\
%
\>[8]\AgdaFunction{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\<%
\\
%
\>[6]\AgdaFunction{simplify-bases}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{simplify-bases}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{cong₂}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
%
\>[12]\AgdaSymbol{(}%
\>[4624I]\AgdaFunction{cong₂}\<%
\\
\>[4624I][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
%
\>[18]\AgdaSymbol{(}\AgdaField{ω-r₁x-r₁y}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
%
\>[18]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}%
\>[16]\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{*ₙ-comm}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ω-r₁x-r₁y}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{remove-constant-term}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{remove-constant-term}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ω-N-mN}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{\})}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{*-identityʳ}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[6]\AgdaFunction{rearrange-ω-power}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}%
\>[15]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
\>[0]\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{rearrange-ω-power}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{-ω-cong₂}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{solve}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaNumber{6}\<%
\\
%
\>[12]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{r₁ℕ}\AgdaSpace{}%
\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaBound{k₀ℕ}\AgdaSpace{}%
\AgdaBound{k₁ℕ}\AgdaSpace{}%
\AgdaBound{j₀ℕ}\AgdaSpace{}%
\AgdaBound{j₁ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{k₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{k₀ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{j₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{j₀ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:=}}\AgdaSpace{}%
\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{j₀ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{k₀ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{j₀ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{r₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{j₁ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:+}}\AgdaSpace{}%
\AgdaBound{r₂ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁ℕ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{:*}}\AgdaSpace{}%
\AgdaBound{k₁ℕ}\AgdaSymbol{)))}\<%
\\
%
\>[12]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[12]\AgdaBound{r₁}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{j₁}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaFunction{split-ω}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaOperator{\AgdaField{*}}\AgdaSpace{}%
\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaFunction{split-ω}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaField{ω-N-k₀+k₁}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))\}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
\>[6][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{flip}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{*ₙ-assoc}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{ω-N-k₀+k₁}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}%
\>[83]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSymbol{)}%
\>[110]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaOperator{\AgdaFunction{⊡}}%
\>[4968I]\AgdaSymbol{(}\AgdaFunction{flip}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[.][@{}l@{}]\<[4968I]%
\>[12]\AgdaSymbol{(}\AgdaField{ω-N-k₀+k₁}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}%
\>[83]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaBound{j₀}%
\>[110]\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{cooley-tukey-derivation-application}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaSymbol{(}\AgdaBound{j₁}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{))}\<%
\\
%
\>[5]\AgdaSymbol{(}\AgdaBound{j₀}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{))}\<%
\\
%
\>[5]\AgdaSymbol{(}\AgdaBound{k₀}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)))}\<%
\\
%
\>[5]\AgdaSymbol{(}\AgdaBound{k₁}%
\>[11]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)))}\<%
\\
%
\>[5]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{nz-r₁}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSymbol{)}\<%
\\
%
\>[5]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{nz-r₂}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSymbol{)}\<%
\\
%
\>[5]\AgdaSymbol{→}\<%
\\
\>[5][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
\>[5][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaOperator{\AgdaField{*}}%
\>[5025I]\AgdaField{-ω}\<%
\\
\>[5025I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{♭}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaOperator{\AgdaField{*}}%
\>[5068I]\AgdaField{-ω}\<%
\\
\>[5068I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
%
\>[8]\AgdaOperator{\AgdaDatatype{≡}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaField{-ω}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaGeneralizable{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
%
\>[12]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{r₁}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaGeneralizable{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
%
\>[2]\AgdaFunction{cooley-tukey-derivation-application}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaKeyword{instance}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-r₁}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-r₂}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaKeyword{in}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{begin}}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}%
\>[5214I]\AgdaFunction{≡⟨}%
\>[10]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}%
\>[5216I]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
\>[5216I][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[16]\AgdaSymbol{(}%
\>[5218I]\AgdaFunction{-ω-cong₂}\<%
\\
\>[5218I][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[20]\AgdaSymbol{(}%
\>[5224I]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\<%
\\
\>[5224I][@{}l@{\AgdaIndent{0}}]%
\>[24]\AgdaSymbol{(}%
\>[5226I]\AgdaSymbol{(}\AgdaFunction{cong}\<%
\\
\>[5226I][@{}l@{\AgdaIndent{0}}]%
\>[30]\AgdaFunction{iota}\<%
\\
%
\>[30]\AgdaSymbol{(}\AgdaFunction{rev-eq}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[5226I]%
\>[26]\AgdaSymbol{)}\<%
\\
%
\>[24]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}))}\<%
\\
%
\>[24]\AgdaSymbol{)}\<%
\\
%
\>[24]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[20]\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaInductiveConstructor{refl}\<%
\\
\>[.][@{}l@{}]\<[5214I]%
\>[6]\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}%
\>[5238I]\AgdaFunction{≡⟨}%
\>[5239I]\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cooley-tukey-derivation}\<%
\\
\>[5239I][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
%
\>[10]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
\>[.][@{}l@{}]\<[5239I]%
\>[9]\AgdaSymbol{)}\<%
\\
\>[5238I][@{}l@{\AgdaIndent{0}}]%
\>[7]\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{≡⟨}%
\>[5258I]\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[5258I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)))}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ\AgdaUnderscore{}}}\AgdaSymbol{))}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaSymbol{(}\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}))}\<%
\\
%
\>[14]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
\>[5258I][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{≡⟨}%
\>[5289I]\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[5289I][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{+ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)))}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaSymbol{(}\AgdaFunction{cong}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ\AgdaUnderscore{}}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{k₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\})))}\<%
\\
%
\>[14]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
\>[5289I][@{}l@{\AgdaIndent{0}}]%
\>[11]\AgdaSymbol{)}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[5]\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+ₙ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}%
\>[5347I]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{sym}%
\>[5349I]\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[5349I][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaSymbol{(}\AgdaFunction{iota-split}\<%
\\
\>[20][@{}l@{\AgdaIndent{0}}]%
\>[22]\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}}\<%
\\
%
\>[22]\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\}}\<%
\\
%
\>[22]\AgdaSymbol{(}\AgdaBound{k₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
%
\>[22]\AgdaSymbol{(}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
%
\>[20]\AgdaSymbol{)}\<%
\\
%
\>[20]\AgdaSymbol{(}\AgdaFunction{iota-split}\<%
\\
\>[20][@{}l@{\AgdaIndent{0}}]%
\>[22]\AgdaSymbol{\{}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)\}}\<%
\\
%
\>[22]\AgdaSymbol{\{}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)\}}\<%
\\
%
\>[22]\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
%
\>[22]\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
%
\>[20]\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{)}\<%
\\
\>[5349I][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{)}\<%
\\
\>[5347I][@{}l@{\AgdaIndent{0}}]%
\>[8]\AgdaFunction{⟩}\<%
\\
%
\>[4]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∎}}\<%
\\
\>[0]\<%
\\
%
\>[2]\AgdaComment{-----------------}\<%
\\
%
\>[2]\AgdaComment{---\ FFT\ ≡\ DFT\ ---}\<%
\\
%
\>[2]\AgdaComment{-----------------}\<%
\\
%
\>[2]\AgdaFunction{fft≅dft}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaBound{nz-s}%
\>[14]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaSymbol{⦄}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar∔}\AgdaSpace{}%
\AgdaGeneralizable{s}\AgdaSpace{}%
\AgdaField{ℂ}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaSymbol{→}%
\>[5388I]\AgdaFunction{FFT}\AgdaSpace{}%
\AgdaBound{arr}\<%
\\
\>[.][@{}l@{}]\<[5388I]%
\>[6]\AgdaOperator{\AgdaFunction{≅}}\<%
\\
%
\>[6]\AgdaSymbol{(}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{DFT}\AgdaSpace{}%
\AgdaSymbol{⦃}\AgdaSpace{}%
\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-s}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{⦄}\AgdaSpace{}%
\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaFunction{flatten-reindex}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaBound{arr}\<%
\\
%
\>[2]\AgdaFunction{fft≅dft}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{N}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{nz-N}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaBound{i}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\>[2]\AgdaFunction{fft≅dft}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{\{}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSpace{}%
\AgdaSymbol{\}\}}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{let}\AgdaSpace{}%
\AgdaKeyword{instance}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaBound{r₁}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{nz-r₁}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{NonZeroₛ}\AgdaSpace{}%
\AgdaBound{r₂}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{nz-r₂}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nz-\#}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{nzᵗ}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{))}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}%
\>[26]\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaBound{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{NonZero}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{m*n≢0}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaKeyword{in}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{begin}}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{fft≅dft}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{DFT-cong}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{fft≅dft}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSpace{}%
\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}%
\>[5523I]\AgdaFunction{≡⟨}%
\>[12]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}%
\>[24]\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(λ}%
\>[5528I]\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[5528I][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{*-distribʳ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{*-distribʳ-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
%
\>[16]\AgdaOperator{\AgdaFunction{⊡}}%
\>[5542I]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[5542I][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaSymbol{(λ}%
\>[5547I]\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[5547I][@{}l@{\AgdaIndent{0}}]%
\>[24]\AgdaFunction{assoc₄}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[20][@{}l@{\AgdaIndent{0}}]%
\>[22]\AgdaOperator{\AgdaFunction{⊡}}%
\>[5553I]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
\>[5553I][@{}l@{\AgdaIndent{0}}]%
\>[26]\AgdaSymbol{(}\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{rev-eq-applied}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊕}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaSymbol{(\AgdaUnderscore{}}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{})))}\<%
\\
%
\>[26]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[20]\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaSymbol{)}\<%
\\
\>[5523I][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{⟩}\<%
\\
%
\>[6]\AgdaSymbol{\AgdaUnderscore{}}%
\>[5565I]\AgdaFunction{≡⟨}%
\>[12]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}%
\>[24]\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaSymbol{(}\AgdaFunction{cooley-tukey-derivation-application}\AgdaSpace{}%
\AgdaBound{j₁}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaBound{nz-r₁}\AgdaSpace{}%
\AgdaBound{nz-r₂}\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
\>[5565I][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{⟩}\<%
\end{code}
%TC:endignore

\begin{code}%
\>[.][@{}l@{}]\<[5565I]%
\>[8]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{sum}%
\>[5593I]\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[5593I]%
\>[16]\AgdaBound{arr}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaSymbol{((}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}%
\>[30]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\}))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊕}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}))}\<%
\\
%
\>[30]\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\<%
\\
%
\>[30]\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaInductiveConstructor{flat}\<%
\\
%
\>[30]\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊕}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaOperator{\AgdaField{*}}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaComment{--\ }\<%
\end{code}

%TC:ignore
\begin{code}[hide]%
\>[16][@{}l@{\AgdaIndent{1}}]%
\>[18]\AgdaSymbol{(}%
\>[23]\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
\>[23][@{}l@{\AgdaIndent{0}}]%
\>[24]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊕}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}))}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
\>[18][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaOperator{\AgdaPrimitive{*ₙ}}%
\>[5635I]\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
\>[5635I][@{}l@{\AgdaIndent{0}}]%
\>[24]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊕}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
%
\>[18]\AgdaSymbol{)}\<%
\end{code}
%TC:endignore

\begin{code}%
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\end{code}

%TC:ignore
\begin{code}[hide]%
%
\>[8]\AgdaFunction{≡⟨}%
\>[12]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSymbol{\})))}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₂}\AgdaSymbol{\}))}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[9]\AgdaFunction{⟩}\<%
\\
\>[9][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\}}\<%
\\
\>[10][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaFunction{sum}%
\>[5665I]\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k₁}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[5665I]%
\>[18]\AgdaBound{arr}\<%
\\
\>[18][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaSymbol{((}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}%
\>[32]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaOperator{\AgdaField{*}}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaComment{--\ }\<%
\\
\>[18][@{}l@{\AgdaIndent{0}}]%
\>[20]\AgdaSymbol{(}%
\>[25]\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{k₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{k₀}\AgdaSymbol{)}\<%
\\
\>[25][@{}l@{\AgdaIndent{0}}]%
\>[26]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
\>[20][@{}l@{\AgdaIndent{0}}]%
\>[22]\AgdaOperator{\AgdaPrimitive{*ₙ}}%
\>[5690I]\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
\>[5690I][@{}l@{\AgdaIndent{0}}]%
\>[26]\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊕}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
%
\>[20]\AgdaSymbol{)}\<%
\\
%
\>[14]\AgdaSymbol{)}\<%
\\
%
\>[12]\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}%
\>[12]\AgdaFunction{sum-swap}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaOperator{\AgdaFunction{⊡}}\AgdaSpace{}%
\AgdaFunction{merge-sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\AgdaUnderscore{}}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[9]\AgdaFunction{⟩}\<%
\\
\>[9][@{}l@{\AgdaIndent{0}}]%
\>[12]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{\}}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaSymbol{(λ}%
\>[5719I]\AgdaBound{k}%
\>[5720I]\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[5720I]%
\>[19]\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaBound{k}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{flat}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊕}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[5719I]%
\>[17]\AgdaOperator{\AgdaField{*}}\<%
\\
\>[17][@{}l@{\AgdaIndent{0}}]%
\>[19]\AgdaField{-ω}\<%
\\
\>[19][@{}l@{\AgdaIndent{0}}]%
\>[21]\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\<%
\\
%
\>[21]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\\
%
\>[14]\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{sum-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaFunction{⟩}\<%
\end{code}
%TC:endignore

As the DFT to compare against takes the following form it is 
clear to see that the next step requires the manipulation these nested sums.
\begin{code}%
\>[8][@{}l@{\AgdaIndent{1}}]%
\>[10]\AgdaFunction{sum}%
\>[5759I]\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(λ}\AgdaSpace{}%
\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[.][@{}l@{}]\<[5759I]%
\>[14]\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{∙}}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\<%
\end{code}
%TC:ignore
\begin{code}[hide]%
\>[0]\<%
\\
\>[0]\<%
\end{code}
%TC:endignore
\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[12]\AgdaOperator{\AgdaField{*}}\<%
\\
\>[12][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaField{-ω}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaComment{--}\<%
\end{code}
%TC:ignore
\begin{code}[hide]%
\>[14][@{}l@{\AgdaIndent{1}}]%
\>[16]\AgdaSymbol{(}\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{k}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{*ₙ}}\AgdaSpace{}%
\AgdaFunction{iota}\AgdaSpace{}%
\AgdaSymbol{(((}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₀}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaFunction{rev}\AgdaSpace{}%
\AgdaFunction{♭}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟨}}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⟩}}\AgdaSymbol{))}\<%
\end{code}
%TC:endignore
\begin{code}%
\>[0][@{}l@{\AgdaIndent{3}}]%
\>[10]\AgdaSymbol{)}\<%
\end{code}

%TC:ignore
\begin{code}[hide]%
\>[0][@{}l@{\AgdaIndent{4}}]%
\>[8]\AgdaFunction{≡⟨}\AgdaSpace{}%
\AgdaFunction{sum-cong}\<%
\\
\>[8][@{}l@{\AgdaIndent{0}}]%
\>[10]\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\}}\<%
\\
%
\>[10]\AgdaSymbol{(λ}%
\>[5814I]\AgdaBound{k}\AgdaSpace{}%
\AgdaSymbol{→}\<%
\\
\>[5814I][@{}l@{\AgdaIndent{0}}]%
\>[14]\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}*\AgdaUnderscore{}}}\<%
\\
\>[14][@{}l@{\AgdaIndent{0}}]%
\>[16]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[16]\AgdaSymbol{(}\AgdaFunction{-ω-cong₂}\<%
\\
\>[16][@{}l@{\AgdaIndent{0}}]%
\>[18]\AgdaInductiveConstructor{refl}\<%
\\
%
\>[18]\AgdaSymbol{(}\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*ₙ\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{iota-reindex}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{|s|≡|sᵗ|}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{\}))}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
%
\>[16]\AgdaSymbol{)}\<%
\\
%
\>[10]\AgdaSymbol{)}\<%
\\
%
\>[8]\AgdaFunction{⟩}\<%
\\
%
\>[8]\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaFunction{♯}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{DFT}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaOperator{\AgdaFunction{\#}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{r₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{r₂}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{ᵗ}}\AgdaSymbol{\})}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaFunction{flatten-reindex}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{arr}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{j₁}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{⊗}}\AgdaSpace{}%
\AgdaBound{j₀}\AgdaSymbol{)}\<%
\\
\>[0][@{}l@{\AgdaIndent{4}}]%
\>[6]\AgdaOperator{\AgdaFunction{∎}}\<%
\end{code}
%TC:endignore
\end{AgdaMultiCode}

This manipulation can be done in four steps.

\paragraph{sum-reindex} can be used (once reversed) to remove the transposition 
on the length of the sum as the length of a shape, and the length of its transpostion
are equal.
This also removes all instances of \AF{reindex} from the right hand side.

%TC:ignore
\begin{code}[hide]%
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Algebra.Structures}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{AlgebraStructures}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{AlgebraStructures}%
\>[24]\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaRecord{IsCommutativeMonoid}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Algebra.Definitions}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{AlgebraDefinitions}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Algebra.Core}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
\AgdaSymbol{as}\AgdaSpace{}%
\AgdaModule{Eq}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Eq}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{sym}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{subst}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{cong-app}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{trans}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Eq.≡-Reasoning}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{MatrixSum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{A}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitive{Set}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaBound{\AgdaUnderscore{}⋆\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Op₂}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{ε}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{isCommutativeMonoid}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{IsCommutativeMonoid}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}⋆\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaBound{ε}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{proj₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{ℕ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{zero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaPrimitive{\AgdaUnderscore{}*\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{*-zeroʳ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{()}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{fzero}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaInductiveConstructor{fsuc}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Ar}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaDatatype{Position}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{ι}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}⊗\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{head₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{tail₁}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitArₗ}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{splitArᵣ}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Equality}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}≅\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reduce-≅}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Properties}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{tail₁-const}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Matrix.Reshape}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{reindex}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{|s|≡|sᵗ|}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⟨\AgdaUnderscore{}⟩}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{split}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaInductiveConstructor{\AgdaUnderscore{}∙\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaInductiveConstructor{eq}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function.Base}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}\$\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{-----------------------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Pull\ out\ properties\ of\ the\ monoid\ ---}\<%
\\
%
\>[2]\AgdaComment{-----------------------------------------}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{AlgebraDefinitions}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaArgument{A}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{IsCommutativeMonoid}\AgdaSpace{}%
\AgdaBound{isCommutativeMonoid}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{identity}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{assoc}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{comm}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaKeyword{private}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaFunction{identityˡ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{LeftIdentity}\AgdaSpace{}%
\AgdaBound{ε}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}⋆\AgdaUnderscore{}}}\<%
\\
%
\>[4]\AgdaFunction{identityˡ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{proj₁}\AgdaSpace{}%
\AgdaFunction{identity}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaFunction{identityʳ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{RightIdentity}\AgdaSpace{}%
\AgdaBound{ε}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}⋆\AgdaUnderscore{}}}\<%
\\
%
\>[4]\AgdaFunction{identityʳ}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{proj₂}\AgdaSpace{}%
\AgdaFunction{identity}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[4]\AgdaKeyword{variable}\<%
\\
\>[4][@{}l@{\AgdaIndent{0}}]%
\>[6]\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaGeneralizable{m}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{----------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Sum\ Definition\ ---}\<%
\\
%
\>[2]\AgdaComment{----------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{A}\<%
\\
%
\>[2]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{ε}\<%
\\
%
\>[2]\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaInductiveConstructor{fzero}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⋆}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{sum}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaFunction{tail₁}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xs}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{----------------------------}\<%
\\
%
\>[2]\AgdaComment{---\ Basic\ Sum\ Properties\ ---}\<%
\\
%
\>[2]\AgdaComment{----------------------------}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{sum-nil}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{∀}%
\>[6001I]\AgdaSymbol{(}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[6001I]%
\>[6]\AgdaSymbol{(}\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaNumber{0}\AgdaSymbol{)}\<%
\\
%
\>[6]\AgdaComment{-----------------}\<%
\\
%
\>[6]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{ε}\<%
\\
%
\>[2]\AgdaFunction{sum-nil}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaBound{ys}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaGeneralizable{n}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{≅}}\AgdaSpace{}%
\AgdaBound{ys}\<%
\\
%
\>[4]\AgdaComment{-----------------}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaBound{ys}\<%
\\
%
\>[2]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSpace{}%
\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\\
%
\>[2]\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{ys}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{cong₂}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{\AgdaUnderscore{}⋆\AgdaUnderscore{}}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaInductiveConstructor{fzero}\AgdaSymbol{))}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{\$}}\AgdaSpace{}%
\AgdaFunction{sum-cong}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reduce-≅}\AgdaSpace{}%
\AgdaBound{prf}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\<%
\end{code}
%TC:endignore
\begin{code}%
\>[0][@{}l@{\AgdaIndent{1}}]%
\>[2]\AgdaFunction{sum-reindex}\AgdaSpace{}%
\AgdaSymbol{:}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaSymbol{∀}%
\>[6060I]\AgdaSymbol{\{}\AgdaBound{m}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[6060I]%
\>[6]\AgdaSymbol{\{}\AgdaBound{xs}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ar}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{ι}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{A}\AgdaSymbol{\}}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{prf}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\>[4]\AgdaComment{-----------------------------------------}\<%
\\
%
\>[4]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSpace{}%
\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
\AgdaFunction{sum}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reshape}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{reindex}\AgdaSpace{}%
\AgdaBound{prf}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{xs}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaFunction{sum-reindex}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaInductiveConstructor{refl}\<%
\end{code}
%TC:ignore
\begin{code}[hide]%
\>[0]\<%
\end{code}
%TC:endignore

\paragraph{sum-swap} can then be used to transition from 
\AF{sum \{\# r₂\} λ k₀ → sum \{\# r₁\} λ k₁ → \_} 
to
\AF{sum \{\# r₁\} λ k₁ → sum \{\# r₂\} λ k₀ → \_}.
The proof which accompanies \AF{sum-swap} is somewhat complicated, and an observant 
reader may ask if this step could be replaced by using the commutativity of
multiplication after \AF{merge-sum}, but this is not the case.
For this papers definition of sum, we state that 
\AF{sum xs ≡ sum ys} when \AF{xs ≅ ys}.
If the commutativity of multiplication was used after \AF{merge-sum} in place of 
\AF{sum-swap} this equality would not hold, as the elements of the tensors on each 
side would be ordered incorrectly.

\paragraph{merge-sum} can then be used to go from two nested sums
\AF{sum \{\# r₁\} λ k₁ → sum \{\# r₂\} λ k₀ → \_}
to a singlular sum, \AF{sum \{\# (r₁ ⊗ r₂)\} λ k → \_}, 
this removes the combination of poisitions, \AF{(k₁ ⊗ k₀) ⟨ split ⟩} from 
the left hand side, replacing it with \AF{k}.

\paragraph{sum-reindex} can then be used to re-apply \AF{reindex}.
This makes the left hand side equal to the right hand side completing the chain
of reasoning.

\subsection{What this means}

The proposition above declares that the result of the DFT is equal to the result
of the FFT.
The chain of reasoning which then follows the proposition proves it to be 
correct.
This provides the guarantee that this definition of the FFT produces the same value
as the DFT.
This guarantee is provided on two generics, the definition of complex, and the shape
meaning it is applicable to any, implementation of complex, or shaped tensor.

As complex is defined generically, any implementation which holds the required properties
can be provided.
This allows for the use of this FFT with its attached guarantees on any finite 
field with complex roots of unity which can hold the required properties.
This allows other formally verified systems operating on such as field to utilise 
the FFT without losing correctness guarantees, invariant of whether such a system
operates on machine floats, or an abstract implementation of complex.

As this implementation is defined generically on the shape of the input tensor,
no restriction is placed on the radix choice.
This allows for the computation of the FFT on any input with a non prime 
length without the need for padding.
If the implementation was instead defined for a fixed radix $r$,
any input would need to be padded to length $r^n$.
This zero padding is required for some implementations of the FFT, but can 
increase the amount of computation required.\cite{Donnelle2005}
% Secondly, defining the FFT upon a tensor of shape $s$, allows for the structure of
% future parallelism to be defined by the shape of $s$.
% This will allow any such parallelism to be equally generic, allowing further experiments
% and allowing customisability for the hardware in use.

These guarantees also allow for this implementation of the FFT to be utilised in
future Agda projects without the loss of correctness guarantees.
This opens the door for any future research projects in Agda which require 
the FFT, allowing for proofs in such projects to be performed on the trivial 
DFT, while methods are implemented on the FFT, simplifying reasoning.





